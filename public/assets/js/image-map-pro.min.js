!function(t){t.imageMapProShapeDefaults={id:"spot-0",title:"",type:"spot",x:-1,y:-1,width:44,height:44,x_image_background:-1,y_image_background:-1,width_image_background:44,height_image_background:44,connected_to:"",use_connected_shape_tooltip:0,layerID:0,static:0,text:{text:"Text",font_family:"sans-serif",font_size:16,font_weight:400,text_color:"#000000",text_opacity:1},actions:{click:"no-action",link:"#",open_link_in_new_window:1,script:""},default_style:{opacity:1,border_radius:50,background_type:"color",background_image_url:"",background_image_opacity:1,background_image_scale:1,background_image_offset_x:0,background_image_offset_y:0,background_color:"#000000",background_opacity:.4,border_width:0,border_style:"solid",border_color:"#ffffff",border_opacity:1,stroke_color:"#ffffff",stroke_opacity:.75,stroke_width:0,stroke_dasharray:"0",stroke_linecap:"round",use_icon:1,icon_type:"library",icon_svg_path:"M409.81,160.113C409.79,71.684,338.136,0,249.725,0C161.276,0,89.583,71.684,89.583,160.113     c0,76.325,119.274,280.238,151.955,334.638c1.72,2.882,4.826,4.641,8.178,4.641c3.351,0,6.468-1.759,8.168-4.631     C290.545,440.361,409.81,236.438,409.81,160.113z M249.716,283.999c-68.303,0-123.915-55.573-123.915-123.895     c0-68.313,55.592-123.895,123.915-123.895s123.876,55.582,123.876,123.895S318.029,283.999,249.716,283.999z",icon_svg_viewbox:"0 0 499.392 499.392",icon_fontawesome_id:"map-marker",icon_fill:"#000000",icon_url:"",icon_is_pin:1,icon_shadow:0},mouseover_style:{opacity:1,border_radius:50,background_image_url:"",background_image_opacity:1,background_image_scale:1,background_image_offset_x:0,background_image_offset_y:0,background_color:"#ffffff",background_opacity:.4,border_width:0,border_style:"solid",border_color:"#ffffff",border_opacity:1,stroke_color:"#ffffff",stroke_opacity:.75,stroke_width:0,stroke_dasharray:"0",stroke_linecap:"round",icon_fill:"#000000"},tooltip:{enable_tooltip:1},tooltip_style:{buffer:40,border_radius:10,padding:15,background_color:"#222222",background_opacity:1,position:"top",width:225,auto_width:1,offset_x:0,offset_y:0},tooltip_content:{squares_settings:{containers:[{id:"sq-container-403761",settings:{elements:[{settings:{name:"Heading",iconClass:"fa fa-header"},options:{heading:{text:"My Shape"}}}]}}]}},points:[],vs:[],svgPathCommands:[],d:"",dEditor:""},t.imageMapProEditorDefaults={id:0,editor:{previewMode:0,selected_shape:-1,transform_tooltip_mode:0,tool:"spot",zoom:1,currentLayer:0,state:{dragging:!1},shapeCounter:{spots:0,rects:0,ovals:0,polys:0,texts:0,paths:0}},runtime:{is_fullscreen:0,layerID:0,menu_search_string:"",menu_scroll:0},general:{name:"",shortcode:"",width:800,height:450,naturalWidth:800,naturalHeight:450,responsive:1,preserve_quality:1,center_image_map:0},image:{url:""},fullscreen:{enable_fullscreen_mode:0,start_in_fullscreen_mode:0,fullscreen_background:"#000000",fullscreen_button_position:1,fullscreen_button_type:"icon_and_text",fullscreen_button_color:"#ffffff",fullscreen_button_text_color:"#222222"},shapes:{pageload_animation:"none",glowing_shapes:0,glowing_shapes_color:"#ffffff",glow_opacity:.5,stop_glowing_on_mouseover:1},tooltips:{enable_tooltips:1,show_tooltips:"mouseover",show_title_on_mouseover:0,sticky_tooltips:0,constrain_tooltips:1,tooltip_animation:"none",fullscreen_tooltips:"mobile-only"},zooming:{enable_zooming:0,max_zoom:16,limit_max_zoom_to_image_size:0,enable_zoom_buttons:1,enable_navigator:1,zoom_button_text_color:"#000000",zoom_button_background_color:"#ffffff",hold_ctrl_to_zoom:1},layers:{enable_layers:0,layers_list:[]},shapes_menu:{enable_shapes_menu:0,detached_menu:0,menu_position:"left",enable_search:1,group_by_floor:0,hide_children_of_connected_shapes:1},custom_code:{custom_css:"",custom_js:""},spots:[]}}(jQuery,(window,document)),function(t){var e=new Array;function i(t){this.settings=t,this.containers=[],this.init()}function s(t){this.settings=t,this.elements=[],this.init()}t.squaresRendererRegisterElement=function(t){e[t.name]=t},t.squaresRendererRenderObject=function(t){if("object"!=typeof t)try{t=JSON.parse(t)}catch(e){return console.log(e),console.log("Squares renderer failed to parse JSON: "),console.log(t),""}return new i(t).render()},i.prototype.init=function(){for(var t=0;t<this.settings.containers.length;t++)this.containers[t]=new s(this.settings.containers[t])},i.prototype.render=function(){for(var t="",e=0;e<this.containers.length;e++)t+=this.containers[e].render();return t},s.prototype.init=function(){if(this.settings.settings)for(var t=0;t<this.settings.settings.elements.length;t++)this.elements[t]=new o(this.settings.settings.elements[t])},s.prototype.render=function(){var t="";if(t+='<div class="squares-container">',this.settings.settings)for(var e=0;e<this.settings.settings.elements.length;e++)t+=this.elements[e].render();return(t+='\t<div class="squares-clear"></div>')+"</div>"};var n={layout:{box_model:{margin:{top:0,bottom:0,left:0,right:0},padding:{top:10,bottom:10,left:10,right:10}},use_grid:1,column_span:{xs:{use:0,class:"sq-col-xs-12",visible:0},sm:{use:0,class:"sq-col-sm-12",visible:0},md:{use:0,class:"sq-col-md-12",visible:1},lg:{use:1,class:"sq-col-lg-12",visible:1}},width:"100",auto_width:1,height:"100",auto_height:1},style:{background_color:"#ffffff",background_opacity:"0",opacity:"1",box_shadow:"none",border_width:"0",border_style:"none",border_color:"#000000",border_opacity:"1",border_radius:"0"},font:{font_family:"sans-serif",font_size:"14",font_weight:"normal",font_style:"normal",line_height:"22",text_color:"#ffffff",text_align:"left",text_decoration:"none",text_transform:"none",text_shadow:""},general:{id:"",classes:"",css:""}};function o(e){this.settings=e.settings,this.defaults=t.extend(!0,{},n),this.elementSpecificDefaults={},this.options=void 0,this.init(e)}function a(t){return(t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t))?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:0,g:0,b:0}}o.prototype.init=function(i){if(this.settings){var s,n=t.extend(!0,{},e[this.settings.name].controls);for(s in n){var o,a=n[s];for(o in this.elementSpecificDefaults[s]={},a){var r=a[o];this.elementSpecificDefaults[s][o]=r.default}}this.defaults=t.extend(!0,{},this.defaults,this.elementSpecificDefaults),this.options=t.extend(!0,{},this.defaults,i.options)}},o.prototype.render=function(){if(this.settings){var t="";return t+='<div class="squares-element '+this.generateLayoutClass(this.options.layout)+'" style="'+this.generateCSS(this.options)+'">',(t+=e[this.settings.name].render(this.options))+"</div>"}},o.prototype.generateLayoutClass=function(){if(this.settings){var t=this.options.layout;if(1!=parseInt(t.use_grid,10))return"";var e="";t=t.column_span;return 1==parseInt(t.xs.use,10)&&(e+=t.xs.class+" ",0==parseInt(t.xs.visible,10)&&(e+="sq-hidden-sm ")),1==parseInt(t.sm.use,10)&&(e+=t.sm.class+" ",0==parseInt(t.sm.visible,10)&&(e+="sq-hidden-md ")),1==parseInt(t.md.use,10)&&(e+=t.md.class+" ",0==parseInt(t.md.visible,10)&&(e+="sq-hidden-lg ")),1==parseInt(t.lg.use,10)&&(e+=t.lg.class+" ",0==parseInt(t.lg.visible,10)&&(e+="sq-hidden-xl ")),e}},o.prototype.generateCSS=function(){if(this.settings){var t="";t+="margin-top: "+(i=this.options.layout).box_model.margin.top+"px; ",t+="margin-bottom: "+i.box_model.margin.bottom+"px; ",t+="margin-left: "+i.box_model.margin.left+"px; ",t+="margin-right: "+i.box_model.margin.right+"px; ",t+="padding-top: "+i.box_model.padding.top+"px; ",t+="padding-bottom: "+i.box_model.padding.bottom+"px; ",t+="padding-left: "+i.box_model.padding.left+"px; ",t+="padding-right: "+i.box_model.padding.right+"px; ",1==parseInt(i.use_grid,10)||(1==parseInt(i.auto_width,10)?t+="width: auto; ":""===i.width||isNaN(i.width)||(t+="width: "+i.width+"px; "),1==parseInt(i.auto_height,10)?t+="height: auto; ":""===i.height||isNaN(i.height)||(t+="height: "+i.height+"px; "));var e,i=this.options.font;return this.options.fontStyles="",i&&(t+="font-family: "+i.font_family+"; ",this.options.fontStyles+="font-family: "+i.font_family+"; ",t+="font-size: "+i.font_size+"px; ",this.options.fontStyles+="font-size: "+i.font_size+"px; ",t+="font-weight: "+i.font_weight+"; ",this.options.fontStyles+="font-weight: "+i.font_weight+"; ",t+="font-style: "+i.font_style+"; ",this.options.fontStyles+="font-style: "+i.font_style+"; ",t+="line-height: "+i.line_height+"px; ",this.options.fontStyles+="line-height: "+i.line_height+"px; ",t+="color: "+i.text_color+"; ",this.options.fontStyles+="color: "+i.text_color+"; ",t+="text-align: "+i.text_align+"; ",this.options.fontStyles+="text-align: "+i.text_align+"; ",t+="text-decoration: "+i.text_decoration+"; ",this.options.fontStyles+="text-decoration: "+i.text_decoration+"; ",t+="text-transform: "+i.text_transform+"; ",this.options.fontStyles+="text-transform: "+i.text_transform+"; ",t+="text-shadow: "+i.text_shadow+"; ",this.options.fontStyles+="text-shadow: "+i.text_shadow+"; "),(i=this.options.style)&&(t+="background-color: rgba("+(e=a(i.background_color)).r+", "+e.g+", "+e.b+", "+i.background_opacity+"); ",t+="opacity: "+i.opacity+"; ",t+="box-shadow: "+i.box_shadow+"; ",t+="border-width: "+i.border_width+"px; ",t+="border-style: "+i.border_style+"; ",t+="border-color: rgba("+(e=a(i.border_color)).r+", "+e.g+", "+e.b+", "+i.border_opacity+"); ",t+="border-radius: "+i.border_radius+"px; "),t}}}(jQuery,(window,document)),function(t,e){var i={name:"Paragraph",iconClass:"fa fa-paragraph",controls:{text:{text:{name:"Text",type:"textarea",default:"Lorem ipsum dolor sit amet, consectetuer adipiscing elit."}}},controlGroupIcons:{text:"fa fa-ellipsis-h"},content:function(){var t=this.controls.text.text.getVal();return t=(t=t.replace(/\\(.)/gm,"$1")).replace(/\n/gm,"<br>"),'<p id="'+this.controls.general.id.getVal()+'" style="'+this.controls.general.css.getVal()+this.fontStyles+' margin: 0; padding: 0;" class="'+this.controls.general.classes.getVal()+'">'+t+"</p>"},render:function(t){var e=t.text.text;return e=(e=e.replace(/\\(.)/gm,"$1")).replace(/\n/gm,"<br>"),'<p id="'+t.general.id+'" style="'+t.general.css+t.fontStyles+' margin: 0; padding: 0;" class="'+t.general.classes+'">'+e+"</p>"}};t.squaresRegisterElement&&t.squaresRegisterElement(i),t.squaresRendererRegisterElement(i),i={name:"Heading",iconClass:"fa fa-header",controls:{heading:{text:{name:"Text",type:"text",default:"Lorem Ipsum"},heading:{name:"Heading",type:"select",options:["h1","h2","h3"],default:"h3"}}},controlGroupIcons:{heading:"fa fa-header"},content:function(){return"<"+this.controls.heading.heading.getVal()+' id="'+this.controls.general.id.getVal()+'" style="'+this.controls.general.css.getVal()+this.fontStyles+' margin: 0; padding: 0;" class="'+this.controls.general.classes.getVal()+'">'+this.controls.heading.text.getVal()+"</"+this.controls.heading.heading.getVal()+">"},render:function(t){return"<"+t.heading.heading+' id="'+t.general.id+'" style="'+t.general.css+t.fontStyles+' margin: 0; padding: 0;" class="'+t.general.classes+'">'+t.heading.text+"</"+t.heading.heading+">"}},t.squaresRegisterElement&&t.squaresRegisterElement(i),t.squaresRendererRegisterElement(i),i={name:"Image",iconClass:"fa fa-camera",controls:{image:{url:{name:"Image URL",type:"text",default:"https://webcraftplugins.com/uploads/placeholder_image.png"},image_is_a_link:{name:"Image is a Link",type:"switch",default:0},link_to:{name:"Link to",type:"text",default:"#"}}},controlGroupIcons:{image:"fa fa-camera"},useFontControls:!1,content:function(){var t="";1==parseInt(this.controls.image.image_is_a_link.getVal(),10)&&(t+='<a href="'+this.controls.image.link_to.getVal()+'">'),t+='<img src="'+this.controls.image.url.getVal()+'" id="'+this.controls.general.id.getVal()+'" style="'+this.controls.general.css.getVal()+'" class="'+this.controls.general.classes.getVal()+'">',1==parseInt(this.controls.image.image_is_a_link.getVal(),10)&&(t+="</a>");var e=new Image;return e.src=this.controls.image.url.getVal(),e.complete||e.addEventListener("load",(function(){})),t},render:function(i){var s="";1==parseInt(i.image.image_is_a_link,10)&&(s+='<a href="'+i.image.link_to+'">'),s+='<img src="'+i.image.url+'" id="'+i.general.id+'" style="'+i.general.css+'" class="'+i.general.classes+'">',1==parseInt(i.image.image_is_a_link,10)&&(s+="</a>");var n=new Image;function o(){t(e).trigger("squares_image_loaded")}return n.src=i.image.url,n.complete?o():n.addEventListener("load",o),s}},t.squaresRegisterElement&&t.squaresRegisterElement(i),t.squaresRendererRegisterElement(i),i={name:"Video",iconClass:"fa fa-video-camera",controls:{video:{mp4_url:{name:"MP4 URL",type:"text",default:"http://webcraftplugins.com/uploads/example_video.mp4"},webm_url:{name:"WEBM URL",type:"text",default:"http://webcraftplugins.com/uploads/example_video.webm"},ogv_url:{name:"OGV URL",type:"text",default:"http://webcraftplugins.com/uploads/example_video.ogv"},video_is_a_link:{name:"Video is a Link",type:"switch",default:0},link_to:{name:"Link to",type:"text",default:"#"},autoplay:{name:"Autoplay",type:"switch",default:0},loop:{name:"Loop",type:"switch",default:0},controls:{name:"Controls",type:"switch",default:0}}},useFontControls:!1,controlGroupIcons:{video:"fa fa-video-camera"},content:function(){var t="";1==parseInt(this.controls.video.video_is_a_link.getVal(),10)&&(t+='<a href="'+this.controls.video.link_to.getVal()+'">');var e="";return 1==parseInt(this.controls.video.autoplay.getVal(),10)&&(e+=" autoplay "),1==parseInt(this.controls.video.loop.getVal(),10)&&(e+=" loop "),1==parseInt(this.controls.video.controls.getVal(),10)&&(e+=" controls "),t+="<video "+e+' id="'+this.controls.general.id.getVal()+'" style="'+this.controls.general.css.getVal()+'" class="'+this.controls.general.classes.getVal()+'"><source src="'+this.controls.video.mp4_url.getVal()+'" type="video/mp4"><source src="'+this.controls.video.webm_url.getVal()+'" type="video/webm"><source src="'+this.controls.video.ogv_url.getVal()+'" type="video/ogv"></video>',1==parseInt(this.controls.video.video_is_a_link.getVal(),10)&&(t+="</a>"),t},render:function(t){var e="";1==parseInt(t.video.video_is_a_link,10)&&(e+='<a href="'+t.video.link_to+'">');var i="";return 1==parseInt(t.video.autoplay,10)&&(i+=" autoplay "),1==parseInt(t.video.loop,10)&&(i+=" loop "),1==parseInt(t.video.controls,10)&&(i+=" controls "),e+="<video "+i+' id="'+t.general.id+'" style="'+t.general.css+'" class="'+t.general.classes+'"><source src="'+t.video.mp4_url+'" type="video/mp4"><source src="'+t.video.webm_url+'" type="video/webm"><source src="'+t.video.ogv_url+'" type="video/ogv"></video>',1==parseInt(t.video.video_is_a_link,10)&&(e+="</a>"),e}},t.squaresRegisterElement&&t.squaresRegisterElement(i),t.squaresRendererRegisterElement(i),i={name:"YouTube",iconClass:"fa fa-youtube",useStyleControls:!1,useFontControls:!1,controls:{youtube:{embed_code:{name:"Embed Code",type:"textarea",default:'<iframe width="560" height="315" src="https://www.youtube.com/embed/6NC_ODHu5jg" frameborder="0" allowfullscreen></iframe>'},allow_fullscreen:{name:"Allow Fullscreen (Doesn't work in Editor)",type:"switch",default:1},iframe_width:{name:"iframe Width",type:"int",default:320},iframe_auto_width:{name:"iframe Auto Width",type:"switch",default:1},iframe_height:{name:"iframe Height",type:"int",default:320}}},controlGroupIcons:{youtube:"fa fa-youtube"},content:function(){var t=this.controls.youtube.embed_code.getVal(),e="";return e+='<div id="'+this.controls.general.id.getVal()+'" style="'+this.controls.general.css.getVal()+'" class="'+this.controls.general.classes.getVal()+'">',t=t.replace("allowfullscreen",""),1==parseInt(this.controls.youtube.allow_fullscreen.getVal(),10)&&-1==t.indexOf("allowfullscreen")&&(t=t.replace("></iframe>"," allowfullscreen></iframe>")),(e+=t=(t=1==parseInt(this.controls.youtube.iframe_auto_width.getVal(),10)?t.replace(/width="\d+"/g,'width="100%"'):t.replace(/width="\d+"/g,'width="'+this.controls.youtube.iframe_width.getVal()+'px"')).replace(/height="\d+"/g,'height="'+this.controls.youtube.iframe_height.getVal()+'px"'))+"</div>"},render:function(t){var e=t.youtube.embed_code,i="";return i+='<div id="'+t.general.id+'" style="'+t.general.css+'" class="'+t.general.classes+'">',e=e.replace("allowfullscreen",""),1==parseInt(t.youtube.allow_fullscreen,10)&&-1==e.indexOf("allowfullscreen")&&(e=e.replace("></iframe>"," allowfullscreen></iframe>")),(i+=e=(e=1==parseInt(t.youtube.iframe_auto_width,10)?e.replace(/width="\d+"/g,'width="100%"'):e.replace(/width="\d+"/g,'width="'+t.youtube.iframe_width+'px"')).replace(/height="\d+"/g,'height="'+t.youtube.iframe_height+'px"'))+"</div>"}},t.squaresRegisterElement&&t.squaresRegisterElement(i),t.squaresRendererRegisterElement(i),i={name:"Button",iconClass:"fa fa-link",controls:{button:{text:{name:"Text",type:"text",default:"Button"},link_to:{name:"Link to",type:"text",default:"#"},new_tab:{name:"Open in New Tab",type:"switch",default:0},display:{name:"Display",type:"button group",options:["inline-block","block"],default:"inline-block"},height:{name:"Height",type:"int",default:44},bg_color:{name:"Background Color",type:"color",default:"#2196f3"},text_color:{name:"Text Color",type:"color",default:"#ffffff"},border_radius:{name:"Border Radius",type:"int",default:10},padding:{name:"Padding Left/Right",type:"int",default:20}}},controlGroupIcons:{button:"fa fa-link"},content:function(){var t="";t+="display: "+this.controls.button.display.getVal()+"; ",t+="height: "+this.controls.button.height.getVal()+"px; ",t+="line-height: "+this.controls.button.height.getVal()+"px; ",t+="background-color: "+this.controls.button.bg_color.getVal()+"; ",t+="color: "+this.controls.button.text_color.getVal()+"; ",t+="border-radius: "+this.controls.button.border_radius.getVal()+"px; ",t+="padding-left: "+this.controls.button.padding.getVal()+"px; ",t+="padding-right: "+this.controls.button.padding.getVal()+"px; ";var e="";return 1==parseInt(this.controls.button.new_tab.getVal(),10)&&(e='target="_blank"'),'<div id="'+this.controls.general.id.getVal()+'" style="'+this.controls.general.css.getVal()+'" class="'+this.controls.general.classes.getVal()+'"><a href="'+this.controls.button.link_to.getVal()+'" style="'+t+'" '+e+' class="squares-button">'+this.controls.button.text.getVal()+"</a></div>"},render:function(t){var e="";e+="display: "+t.button.display+"; ",e+="height: "+t.button.height+"px; ",e+="line-height: "+t.button.height+"px; ",e+="background-color: "+t.button.bg_color+"; ",e+="color: "+t.button.text_color+"; ",e+="border-radius: "+t.button.border_radius+"px; ",e+="padding-left: "+t.button.padding+"px; ",e+="padding-right: "+t.button.padding+"px; ";var i="";return 1==parseInt(t.button.new_tab,10)&&(i='target="_blank"'),'<div id="'+t.general.id+'" style="'+t.general.css+'" class="'+t.general.classes+'"><a href="'+t.button.link_to+'" style="'+e+'" '+i+' class="squares-button">'+t.button.text+"</a></div>"}},t.squaresRegisterElement&&t.squaresRegisterElement(i),t.squaresRendererRegisterElement(i)}(jQuery,(window,document)),function($,window,document,undefined){"use strict";var fullscreenMap=undefined,fullscreenMapParent=undefined,touch=!1;$.imageMapProInitialized=function(t){},$.imageMapProEventHighlightedShape=function(t,e){},$.imageMapProEventUnhighlightedShape=function(t,e){},$.imageMapProEventClickedShape=function(t,e){},$.imageMapProEventOpenedTooltip=function(t,e){},$.imageMapProEventClosedTooltip=function(t,e){},$.imageMapProEventSwitchedFloor=function(t,e){},$.imageMapProHighlightShape=function(t,e){var i=findImageMapWithName(t);if(i&&(e=findShapeWithTitle(i.settings.general.name,e))){var s=e.shape,n=e.index;if(-1===i.apiHighlightedShapes.indexOf(n)&&i.apiHighlightedShapes.push(n),i.connectedShapes[s.id])for(var o=0;o<i.connectedShapes[s.id].length;o++){var a=i.connectedShapes[s.id][o].index;-1===i.apiHighlightedShapes.indexOf(a)&&i.apiHighlightedShapes.push(a)}APIFunctionQueueAddAction((function(t){i.highlightShape(n),t()}))}},$.imageMapProUnhighlightShape=function(t,e){var i=findImageMapWithName(t);if(i&&(e=findShapeWithTitle(i.settings.general.name,e))){var s=e.shape,n=e.index;if(-1!=i.apiHighlightedShapes.indexOf(n)&&(e=i.apiHighlightedShapes.indexOf(n),i.apiHighlightedShapes.splice(e,1)),i.connectedShapes[s.id])for(var o=0;o<i.connectedShapes[s.id].length;o++){var a=i.connectedShapes[s.id][o].index,r=i.apiHighlightedShapes.indexOf(a);i.apiHighlightedShapes.splice(r,1),APIFunctionQueueAddAction((function(t){i.unhighlightShape(a),t()}))}APIFunctionQueueAddAction((function(t){i.unhighlightShape(n),t()}))}},$.imageMapProFocusShape=function(t,e){var i,s,n=findImageMapWithName(t);!n||(e=findShapeWithTitle(n.settings.general.name,e))&&(i=e.shape,s=e.index,parseInt(i.layerID,10)!==parseInt(n.settings.runtime.layerID,10)&&APIFunctionQueueAddAction((function(t){n.switchLayer(i.layerID,(function(){t()}))})),APIFunctionQueueAddAction((function(t){n.focusShape(s),t()})),APIFunctionQueueAddAction((function(t){n.highlightShape(s),t()})))},$.imageMapProOpenTooltip=function(t,e){var i,s=findImageMapWithName(t);!s||(e=findShapeWithTitle(s.settings.general.name,e))&&(e.shape,i=e.index,APIFunctionQueueAddAction((function(t){s.showTooltip(i),t()})),APIFunctionQueueAddAction((function(t){s.updateTooltipPosition(i),t()})),-1===s.apiOpenedTooltips.indexOf(i)&&s.apiOpenedTooltips.push(i))},$.imageMapProHideTooltip=function(t,e){var i,s=findImageMapWithName(t);!s||(e=findShapeWithTitle(s.settings.general.name,e))&&(e.shape,i=e.index,-1!=s.apiOpenedTooltips.indexOf(i)&&(e=s.apiOpenedTooltips.indexOf(i),s.apiOpenedTooltips.splice(e,1)),APIFunctionQueueAddAction((function(t){s.hideTooltip(i),t()})))},$.imageMapProReInitMap=function(t){(t=findImageMapWithName(t))&&t.init()},$.imageMapProIsMobile=function(){return isMobile()},$.imageMapProGoToFloor=function(t,e){var i=findImageMapWithName(t);if(i){for(var s=0,n=0;n<i.settings.layers.layers_list.length;n++)i.settings.layers.layers_list[n].title===e&&(s=i.settings.layers.layers_list[n].id);APIFunctionQueueAddAction((function(t){i.switchLayer(s),t()}))}},$.imageMapProZoomIn=function(t){(t=findImageMapWithName(t))&&t.zoomIn()},$.imageMapProZoomOut=function(t){(t=findImageMapWithName(t))&&t.zoomOut()};var APIFunctionQueue=[];function findShapeWithTitle(t,e){var i=$('[data-shape-title="'+e+'"]').data("index"),s=instances[t].settings.spots[i];if(!s){for(var n=0;n<instances[t].settings.spots.length;n++)instances[t].settings.spots[n].title===e&&(s=instances[t].settings.spots[n],i=n);if(!s)return console.log("Error: Could not find shape with name: "+e),undefined}return{shape:s,index:i}}function findImageMapWithName(t){for(var e in instances)if(instances[e].settings.general.name===t)return instances[e];for(var e in console.log('Image map with name "'+t+'" not found, returning the first found image map instead.'),instances)return instances[e];return console.log("Error: No image maps found!"),undefined}function APIFunctionQueueAddAction(t){var e=APIFunctionQueue.length;APIFunctionQueue.push(t),0===e&&APIFunctionQueuePopAction()}function APIFunctionQueuePopAction(){APIFunctionQueue[0]((function(){APIFunctionQueue.shift(),0<APIFunctionQueue.length&&APIFunctionQueuePopAction()}))}$(document).ready((function(){$(document).on("mouseover","[data-imp-highlight-shape-on-mouseover]",(function(){var t,e=$(this).data("imp-highlight-shape-on-mouseover"),i=findImageMapWithName($(this).data("imp-image-map-name"));!i||(e=findShapeWithTitle(i.settings.general.name,e))&&(e.shape,t=e.index,APIFunctionQueueAddAction((function(e){i.highlightShape(t,!0),e()})))})),$(document).on("mouseout","[data-imp-highlight-shape-on-mouseover]",(function(){var t=$(this).data("imp-highlight-shape-on-mouseover"),e=findImageMapWithName($(this).data("imp-image-map-name"));!e||(t=findShapeWithTitle(e.settings.general.name,t))&&(t.shape,t.index,APIFunctionQueueAddAction((function(t){e.unhighlightAllShapes(),t()})))})),$(document).on("click","[data-imp-highlight-shape-on-click]",(function(){var t=$(this).data("imp-highlight-shape-on-click"),e=findImageMapWithName($(this).data("imp-image-map-name"));if(e&&(t=findShapeWithTitle(e.settings.general.name,t))){var i=t.shape,s=t.index;if(parseInt(i.layerID,10)!==parseInt(e.settings.runtime.layerID,10)&&APIFunctionQueueAddAction((function(t){e.switchLayer(i.layerID,(function(){t()}))})),APIFunctionQueueAddAction((function(t){e.highlightShape(s,!0),t()})),-1===e.apiHighlightedShapes.indexOf(s)&&e.apiHighlightedShapes.push(s),e.connectedShapes[i.id])for(var n=0;n<e.connectedShapes[i.id].length;n++){var o=e.connectedShapes[i.id][n].index;-1===e.apiHighlightedShapes.indexOf(o)&&e.apiHighlightedShapes.push(o)}}})),$(document).on("mouseover","[data-imp-unhighlight-shape-on-mouseover]",(function(){var t=$(this).data("imp-unhighlight-shape-on-mouseover"),e=findImageMapWithName($(this).data("imp-image-map-name"));if(e&&(t=findShapeWithTitle(e.settings.general.name,t))){var i=t.shape,s=t.index;if(-1!=e.apiHighlightedShapes.indexOf(s)&&(t=e.apiHighlightedShapes.indexOf(s),e.apiHighlightedShapes.splice(t,1)),parseInt(i.layerID,10)!==parseInt(e.settings.runtime.layerID,10)&&APIFunctionQueueAddAction((function(t){e.switchLayer(i.layerID,(function(){t()}))})),e.connectedShapes[i.id])for(var n=0;n<e.connectedShapes[i.id].length;n++){var o=e.connectedShapes[i.id][n].index,a=e.apiHighlightedShapes.indexOf(o);e.apiHighlightedShapes.splice(a,1),APIFunctionQueueAddAction((function(t){e.unhighlightShape(o),t()}))}APIFunctionQueueAddAction((function(t){e.unhighlightShape(s),t()}))}})),$(document).on("click","[data-imp-unhighlight-shape-on-click]",(function(){var t=$(this).data("imp-unhighlight-shape-on-click"),e=findImageMapWithName($(this).data("imp-image-map-name"));if(e&&(t=findShapeWithTitle(e.settings.general.name,t))){var i=t.shape,s=t.index;if(-1!=e.apiHighlightedShapes.indexOf(s)&&(t=e.apiHighlightedShapes.indexOf(s),e.apiHighlightedShapes.splice(t,1)),parseInt(i.layerID,10)!==parseInt(e.settings.runtime.layerID,10)&&APIFunctionQueueAddAction((function(t){e.switchLayer(i.layerID,(function(){t()}))})),e.connectedShapes[i.id])for(var n=0;n<e.connectedShapes[i.id].length;n++){var o=e.connectedShapes[i.id][n].index,a=e.apiHighlightedShapes.indexOf(o);e.apiHighlightedShapes.splice(a,1),APIFunctionQueueAddAction((function(t){e.unhighlightShape(o),t()}))}APIFunctionQueueAddAction((function(t){e.unhighlightShape(s),t()}))}})),$(document).on("mouseover","[data-imp-open-tooltip-on-mouseover]",(function(){var t,e,i=$(this).data("imp-open-tooltip-on-mouseover"),s=findImageMapWithName($(this).data("imp-image-map-name"));!s||(i=findShapeWithTitle(s.settings.general.name,i))&&(t=i.shape,e=i.index,parseInt(t.layerID,10)!==parseInt(s.settings.runtime.layerID,10)&&APIFunctionQueueAddAction((function(e){s.switchLayer(t.layerID,(function(){e()}))})),APIFunctionQueueAddAction((function(t){s.showTooltip(e),t()})),APIFunctionQueueAddAction((function(t){s.updateTooltipPosition(e),t()})),-1===s.apiOpenedTooltips.indexOf(e)&&s.apiOpenedTooltips.push(e))})),$(document).on("mouseout","[data-imp-open-tooltip-on-mouseover]",(function(){var t,e=$(this).data("imp-open-tooltip-on-mouseover"),i=findImageMapWithName($(this).data("imp-image-map-name"));!i||(e=findShapeWithTitle(i.settings.general.name,e))&&(t=e.shape,e=e.index,parseInt(t.layerID,10)!==parseInt(i.settings.runtime.layerID,10)&&APIFunctionQueueAddAction((function(e){i.switchLayer(t.layerID,(function(){e()}))})),APIFunctionQueueAddAction((function(t){i.hideAllTooltips(),t()})),-1!=i.apiOpenedTooltips.indexOf(e)&&(e=i.apiOpenedTooltips.indexOf(e),i.apiOpenedTooltips.splice(e,1)))})),$(document).on("click","[data-imp-open-tooltip-on-click]",(function(){var t,e,i=$(this).data("imp-open-tooltip-on-click"),s=findImageMapWithName($(this).data("imp-image-map-name"));!s||(i=findShapeWithTitle(s.settings.general.name,i))&&(t=i.shape,e=i.index,parseInt(t.layerID,10)!==parseInt(s.settings.runtime.layerID,10)&&APIFunctionQueueAddAction((function(e){s.switchLayer(t.layerID,(function(){e()}))})),APIFunctionQueueAddAction((function(t){s.showTooltip(e),t()})),APIFunctionQueueAddAction((function(t){s.updateTooltipPosition(e),t()})),-1===s.apiOpenedTooltips.indexOf(e)&&s.apiOpenedTooltips.push(e))})),$(document).on("mouseover","[data-imp-close-tooltip-on-mouseover]",(function(){var t,e,i=$(this).data("imp-close-tooltip-on-mouseover"),s=findImageMapWithName($(this).data("imp-image-map-name"));!s||(i=findShapeWithTitle(s.settings.general.name,i))&&(t=i.shape,e=i.index,parseInt(t.layerID,10)!==parseInt(s.settings.runtime.layerID,10)&&APIFunctionQueueAddAction((function(e){s.switchLayer(t.layerID,(function(){e()}))})),-1!=s.apiOpenedTooltips.indexOf(e)&&(i=s.apiOpenedTooltips.indexOf(e),s.apiOpenedTooltips.splice(i,1)),APIFunctionQueueAddAction((function(t){s.hideTooltip(e),t()})))})),$(document).on("click","[data-imp-close-tooltip-on-click]",(function(){var t,e,i=$(this).data("imp-close-tooltip-on-click"),s=findImageMapWithName($(this).data("imp-image-map-name"));!s||(i=findShapeWithTitle(s.settings.general.name,i))&&(t=i.shape,e=i.index,parseInt(t.layerID,10)!==parseInt(s.settings.runtime.layerID,10)&&APIFunctionQueueAddAction((function(e){s.switchLayer(t.layerID,(function(){e()}))})),-1!=s.apiOpenedTooltips.indexOf(e)&&(i=s.apiOpenedTooltips.indexOf(e),s.apiOpenedTooltips.splice(i,1)),APIFunctionQueueAddAction((function(t){s.hideTooltip(e),t()})))})),$(document).on("mouseover","[data-imp-trigger-shape-on-mouseover]",(function(){var t=$(this).data("imp-trigger-shape-on-mouseover"),e=findImageMapWithName($(this).data("imp-image-map-name"));if(e&&(t=findShapeWithTitle(e.settings.general.name,t))){var i=t.shape,s=t.index;if(parseInt(i.layerID,10)!==parseInt(e.settings.runtime.layerID,10)&&APIFunctionQueueAddAction((function(t){e.switchLayer(i.layerID,(function(){t()}))})),APIFunctionQueueAddAction((function(t){e.highlightShape(s,!0),t()})),APIFunctionQueueAddAction((function(t){e.showTooltip(s),t()})),APIFunctionQueueAddAction((function(t){e.updateTooltipPosition(s),t()})),-1===e.apiOpenedTooltips.indexOf(s)&&e.apiOpenedTooltips.push(s),-1===e.apiHighlightedShapes.indexOf(s)&&e.apiHighlightedShapes.push(s),e.connectedShapes[i.id])for(var n=0;n<e.connectedShapes[i.id].length;n++){var o=e.connectedShapes[i.id][n].index;-1===e.apiHighlightedShapes.indexOf(o)&&e.apiHighlightedShapes.push(o)}}})),$(document).on("mouseout","[data-imp-trigger-shape-on-mouseover]",(function(){var t=$(this).data("imp-trigger-shape-on-mouseover"),e=findImageMapWithName($(this).data("imp-image-map-name"));if(e&&(t=findShapeWithTitle(e.settings.general.name,t))){var i,s=t.shape,n=t.index;if(parseInt(s.layerID,10)!==parseInt(e.settings.runtime.layerID,10)&&APIFunctionQueueAddAction((function(t){e.switchLayer(s.layerID,(function(){t()}))})),-1!=e.apiHighlightedShapes.indexOf(n)&&(i=e.apiHighlightedShapes.indexOf(n),e.apiHighlightedShapes.splice(i,1)),e.connectedShapes[s.id])for(var o=0;o<e.connectedShapes[s.id].length;o++){var a=e.connectedShapes[s.id][o].index,r=e.apiHighlightedShapes.indexOf(a);e.apiHighlightedShapes.splice(r,1),APIFunctionQueueAddAction((function(t){e.unhighlightShape(a),t()}))}APIFunctionQueueAddAction((function(t){e.unhighlightShape(n),t()})),-1!=e.apiOpenedTooltips.indexOf(n)&&(i=e.apiOpenedTooltips.indexOf(n),e.apiOpenedTooltips.splice(i,1)),APIFunctionQueueAddAction((function(t){e.hideTooltip(n),t()}))}})),$(document).on("click","[data-imp-trigger-shape-on-click]",(function(){var t=$(this).data("imp-trigger-shape-on-click"),e=findImageMapWithName($(this).data("imp-image-map-name"));if(e&&(t=findShapeWithTitle(e.settings.general.name,t))){var i=t.shape,s=t.index;if(parseInt(i.layerID,10)!==parseInt(e.settings.runtime.layerID,10)&&APIFunctionQueueAddAction((function(t){e.switchLayer(i.layerID,(function(){t()}))})),APIFunctionQueueAddAction((function(t){e.highlightShape(s,!0),t()})),APIFunctionQueueAddAction((function(t){e.showTooltip(s),t()})),APIFunctionQueueAddAction((function(t){e.updateTooltipPosition(s),t()})),-1===e.apiOpenedTooltips.indexOf(s)&&e.apiOpenedTooltips.push(s),-1===e.apiHighlightedShapes.indexOf(s)&&e.apiHighlightedShapes.push(s),e.connectedShapes[i.id])for(var n=0;n<e.connectedShapes[i.id].length;n++){var o=e.connectedShapes[i.id][n].index;-1===e.apiHighlightedShapes.indexOf(o)&&e.apiHighlightedShapes.push(o)}}})),$(document).on("mouseover","[data-imp-untrigger-shape-on-mouseover]",(function(){var t=$(this).data("imp-untrigger-shape-on-mouseover"),e=findImageMapWithName($(this).data("imp-image-map-name"));if(e&&(t=findShapeWithTitle(e.settings.general.name,t))){var i,s=t.shape,n=t.index;if(parseInt(s.layerID,10)!==parseInt(e.settings.runtime.layerID,10)&&APIFunctionQueueAddAction((function(t){e.switchLayer(s.layerID,(function(){t()}))})),-1!=e.apiHighlightedShapes.indexOf(n)&&(i=e.apiHighlightedShapes.indexOf(n),e.apiHighlightedShapes.splice(i,1)),e.connectedShapes[s.id])for(var o=0;o<e.connectedShapes[s.id].length;o++){var a=e.connectedShapes[s.id][o].index,r=e.apiHighlightedShapes.indexOf(a);e.apiHighlightedShapes.splice(r,1),APIFunctionQueueAddAction((function(t){e.unhighlightShape(a),t()}))}APIFunctionQueueAddAction((function(t){e.unhighlightShape(n),t()})),-1!=e.apiOpenedTooltips.indexOf(n)&&(i=e.apiOpenedTooltips.indexOf(n),e.apiOpenedTooltips.splice(i,1)),APIFunctionQueueAddAction((function(t){e.hideTooltip(n),t()}))}})),$(document).on("click","[data-imp-untrigger-shape-on-click]",(function(){var t=$(this).data("imp-untrigger-shape-on-click"),e=findImageMapWithName($(this).data("imp-image-map-name"));if(e&&(t=findShapeWithTitle(e.settings.general.name,t))){var i,s=t.shape,n=t.index;if(parseInt(s.layerID,10)!==parseInt(e.settings.runtime.layerID,10)&&APIFunctionQueueAddAction((function(t){e.switchLayer(s.layerID,(function(){t()}))})),-1!=e.apiHighlightedShapes.indexOf(n)&&(i=e.apiHighlightedShapes.indexOf(n),e.apiHighlightedShapes.splice(i,1)),e.connectedShapes[s.id])for(var o=0;o<e.connectedShapes[s.id].length;o++){var a=e.connectedShapes[s.id][o].index,r=e.apiHighlightedShapes.indexOf(a);e.apiHighlightedShapes.splice(r,1),APIFunctionQueueAddAction((function(t){e.unhighlightShape(a),t()}))}APIFunctionQueueAddAction((function(t){e.unhighlightShape(n),t()})),-1!=e.apiOpenedTooltips.indexOf(n)&&(i=e.apiOpenedTooltips.indexOf(n),e.apiOpenedTooltips.splice(i,1)),APIFunctionQueueAddAction((function(t){e.hideTooltip(n),t()}))}})),$(document).on("mouseover","[data-imp-focus-shape-on-mouseover]",(function(){var t,e,i=$(this).data("imp-focus-shape-on-mouseover"),s=findImageMapWithName($(this).data("imp-image-map-name"));!s||(i=findShapeWithTitle(s.settings.general.name,i))&&(t=i.shape,e=i.index,parseInt(t.layerID,10)!==parseInt(s.settings.runtime.layerID,10)&&APIFunctionQueueAddAction((function(e){s.switchLayer(t.layerID,(function(){e()}))})),APIFunctionQueueAddAction((function(t){s.focusShape(e),t()})),APIFunctionQueueAddAction((function(t){s.unhighlightAllShapes(),t()})),APIFunctionQueueAddAction((function(t){s.highlightShape(e),t()})))})),$(document).on("click","[data-imp-focus-shape-on-click]",(function(){var t,e,i=$(this).data("imp-focus-shape-on-click"),s=findImageMapWithName($(this).data("imp-image-map-name"));!s||(i=findShapeWithTitle(s.settings.general.name,i))&&(t=i.shape,e=i.index,s.hideResponsiveShapesMenu(),parseInt(t.layerID,10)!==parseInt(s.settings.runtime.layerID,10)&&APIFunctionQueueAddAction((function(e){s.switchLayer(t.layerID,(function(){e()}))})),APIFunctionQueueAddAction((function(t){s.focusShape(e),t()})),APIFunctionQueueAddAction((function(t){s.unhighlightAllShapes(),t()})),APIFunctionQueueAddAction((function(t){s.highlightShape(e),t()})))})),$(document).on("click","[data-imp-go-to-floor]",(function(){var t=$(this).data("imp-go-to-floor"),e=findImageMapWithName($(this).data("imp-image-map-name"));if(e){for(var i=0,s=0;s<e.settings.layers.layers_list.length;s++)e.settings.layers.layers_list[s].title===t&&(i=e.settings.layers.layers_list[s].id);e.switchLayer(i)}}))}));var pluginName="imageMapPro",default_settings=$.imageMapProEditorDefaults,default_spot_settings=$.imageMapProShapeDefaults,instances=new Array;function Plugin(t,e){this.element=t,this.settings=$.extend(!0,{},default_settings,e),this.root=$(t),this.wrap=undefined,this.shapesMenuWrap=undefined,this.shapesMenuResponsiveButton=undefined,this.zoomWrap=undefined,this.translateWrap=undefined,this.ui=undefined,this.uiNavigatorRoot=undefined,this.uiNavigatorWindowWidth=undefined,this.uiNavigatorWindowHeight=undefined,this.uiNavigatorImage=undefined,this.shapeContainer=undefined,this.imageBackgroundsContainer=undefined,this.shapeSvgContainer=undefined,this.fullscreenTooltipsContainer=undefined,this.tooltipsContainer=undefined,this.scrollMessage=undefined,this.responsiveShapesMenu=!1,this.responsiveShapesMenuWrap=!1,this.wrapWidth=0,this.wrapHeight=0,this.wrapOffsetLeft=0,this.wrapOffsetTop=0,this.visibleFullscreenTooltip=undefined,this.visibleFullscreenTooltipIndex=undefined,this.bodyOverflow=undefined,this.highlightedShapes=new Array,this.connectedShapes=new Array,this.openedTooltips=new Array,this.apiHighlightedShapes=new Array,this.apiOpenedTooltips=new Array,this.hideScrollMessageTimeout=undefined,this.targetZoom=1,this.zoom=1,this.maxZoomLevel=8,this.zoomMultiplier=1.45,this.targetPanX=0,this.actualPanX=0,this.targetPanY=0,this.actualPanY=0,this.initialPanX=0,this.initialPanY=0,this.panDeltaY=0,this.ix=0,this.iy=0,this.lastX=0,this.lastY=0,this.pinchInitial=[{x:0,y:0},{x:0,y:0}],this.pinchInitialDistance=0,this.pinchInitialZoom=0,this.navigatorRatio=1,this.navigatorMarginX=0,this.navigatorMarginY=0,this.touch=!1,this.fullscreenTooltipVisible=!1,this.panning=!1,this.didPan=!1,this.panningOnNavigator=!1,this.pinching=!1,this.didAnimateShapesOnPageload=!1,this.ctrlKeyDown=!1,this.cmdKeyDown=!1,this.mac=!1,this.lastWrapRecalc=0,this.init()}function isTrue(t){return 1===parseInt(t,10)}function hexToRgb(t){return(t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t))?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:0,g:0,b:0}}function screenToImageMapSpace(t,e,i){return Math.round(1e3*(t-i.offset().left)),Math.round(1e3*(e-i.offset().top)),1}function isPointInsideRect(t,e,i,s,n,o){return i<=t&&t<=i+n&&s<=e&&e<=s+o}function isPointInsidePolygon(t,e,i){for(var s=!1,n=0,o=i.length-1;n<i.length;o=n++){var a=i[n][0],r=i[n][1],h=i[o][0],l=i[o][1];e<r!=e<l&&t<(h-a)*(e-r)/(l-r)+a&&(s=!s)}return s}function isPointInsideEllipse(t,e,i,s,n,o){return(t-i)*(t-i)/(n*n)+(e-s)*(e-s)/(o*o)<=1}function fitRectToScreen(t,e,i,s){return e<0&&(e=0),{x:t=(t=t<0?0:t)>$(document).width()-i?$(document).width()-i:t,y:e=e>$(document).height()-s?$(document).height()-s:e}}function shuffle(t){for(var e,i,s=t.length;0!==s;)i=Math.floor(Math.random()*s),e=t[--s],t[s]=t[i],t[i]=e;return t}function isMobile(){return!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function lerp(t,e,i){return t*(1-i)+e*i}function easeOutBounce(t,e,i,s,n){return(e/=n)<1/2.75?s*(7.5625*e*e)+i:e<2/2.75?s*(7.5625*(e-=1.5/2.75)*e+.75)+i:e<2.5/2.75?s*(7.5625*(e-=2.25/2.75)*e+.9375)+i:s*(7.5625*(e-=2.625/2.75)*e+.984375)+i}$.extend(Plugin.prototype,{init:function(t){this.parseSettings(),(instances[this.settings.general.name]=this).id=100*Math.random(),this.connectedShapes=[];for(var e,i=0;i<this.settings.spots.length;i++){var s=this.settings.spots[i],n=$.extend(!0,{},default_spot_settings);s=$.extend(!0,n,s),this.settings.spots[i]=$.extend(!0,{},s),this.settings.spots[i].title&&0!==this.settings.spots[i].title.length||(this.settings.spots[i].title=this.settings.spots[i].id),""!=s.connected_to&&(this.connectedShapes[s.connected_to]||(this.connectedShapes[s.connected_to]=new Array),this.connectedShapes[s.connected_to].push({id:s.id,index:i})),this.settings.spots[i].mouseover_style.background_type=this.settings.spots[i].default_style.background_type}if(isTrue(this.settings.layers.enable_layers)){var o=!1;for(i=0;i<this.settings.layers.layers_list.length;i++)parseInt(this.settings.layers.layers_list[i].id,10)===parseInt(this.settings.runtime.layerID,10)&&(o=!0,this.settings.image.url=this.settings.layers.layers_list[i].image_url);o||(this.settings.image.url=this.settings.layers.layers_list[0].image_url,this.settings.runtime.layerID=this.settings.layers.layers_list[0].id)}this.mac=0<=navigator.platform.toUpperCase().indexOf("MAC"),""!=this.settings.image.url?((a=new Image).src=this.settings.image.url,(e=this).loadImage(a,(function(){}),(function(){e.finishInit(t)}))):this.finishInit(t);var a;for(i=0;i<this.settings.spots.length;i++)"image"===(s=this.settings.spots[i]).default_style.background_type&&((a=new Image).src=s.mouseover_style.background_image_url,$(a).on("load",(function(){})))},finishInit:function(t){var e=this.root.width();this.settings.runtime.is_fullscreen&&(e=$(window).width()),(isMobile()||e/3<240)&&(this.responsiveShapesMenu=!0);var i="";e="";if(i+='<div class="imp-wrap '+(e=isTrue(this.settings.tooltips.sticky_tooltips)?"imp-sticky-tooltips":e)+'">',i+='   <div class="imp-ui" data-image-map-pro-ui-id="'+this.settings.id+'">',isTrue(this.settings.zooming.enable_zooming)&&isTrue(this.settings.zooming.enable_navigator)&&(i+='       <div data-imp-id="'+this.settings.id+'" class="imp-ui-element imp-ui-navigator-root">',""!=this.settings.image.url&&(i+='         <img src="'+this.settings.image.url+'" class="imp-ui-navigator-background-image-edgefill">',i+='         <img src="'+this.settings.image.url+'" class="imp-ui-navigator-background-image">'),i+='         <div class="imp-ui-navigator-overlay"></div>',""!=this.settings.image.url&&(i+='         <img src="'+this.settings.image.url+'" class="imp-ui-navigator-window-image">'),i+="      </div>"),isTrue(this.settings.zooming.enable_zooming)&&isTrue(this.settings.zooming.enable_zoom_buttons)&&(i+='       <div data-imp-id="'+this.settings.id+'" class="imp-ui-element imp-ui-zoom-button imp-ui-zoom-button-zoom-in" style="color: '+this.settings.zooming.zoom_button_text_color+"; background: "+this.settings.zooming.zoom_button_background_color+';"><i class="fa fa-plus"></i></div>',i+='       <div data-imp-id="'+this.settings.id+'" class="imp-ui-element imp-ui-zoom-button imp-ui-zoom-button-zoom-out" style="color: '+this.settings.zooming.zoom_button_text_color+"; background: "+this.settings.zooming.zoom_button_background_color+';"><i class="fa fa-minus"></i></div>'),isTrue(this.settings.layers.enable_layers)){i+='<div class="imp-ui-layers-menu-wrap">',i+='   <div data-imp-id="'+this.settings.id+'" class="imp-ui-layer-switch-up imp-ui-layer-switch"><i class="fa fa-caret-up" aria-hidden="true"></i></div>',i+='   <div data-imp-id="'+this.settings.id+'" class="imp-ui-layer-switch-down imp-ui-layer-switch"><i class="fa fa-caret-down" aria-hidden="true"></i></div>',i+='   <select class="imp-ui-element imp-ui-layers-select">';for(var s=0;s<this.settings.layers.layers_list.length;s++)i+='<option value="'+this.settings.layers.layers_list[s].id+'">'+this.settings.layers.layers_list[s].title+"</option>";i+="   </select>",i+="</div>"}isTrue(this.settings.zooming.enable_zooming)&&isTrue(this.settings.zooming.hold_ctrl_to_zoom)&&(e="CTRL",i+='<div class="imp-ui-scroll-message-wrap">',i+='   <div class="imp-ui-scroll-message-wrap-inner">',i+='       <div class="imp-ui-scroll-message">Hold <div class="imp-ui-scroll-message-button">'+(e=this.mac?"⌘":e)+"</div> to Zoom</div>",i+="   </div>",i+="</div>"),i+="   </div>",i+='   <div class="imp-zoom-outer-wrap">',i+='       <div class="imp-translate-wrap">',i+='           <div class="imp-zoom-wrap">',""!=this.settings.image.url&&(i+='               <img src="'+this.settings.image.url+'" class="imp-main-image">'),i+="           </div>",i+="       </div>",i+="   </div>",this.root.html(i+="</div>"),this.wrap=this.root.find(".imp-wrap"),this.zoomWrap=this.root.find(".imp-zoom-wrap"),this.translateWrap=this.root.find(".imp-translate-wrap"),this.ui=this.wrap.find(".imp-ui"),this.scrollMessage=this.wrap.find(".imp-ui-scroll-message-wrap"),this.root.addClass("imp-initialized"),this.root.attr("data-image-map-pro-id",this.settings.id),$('[data-imp-tooltips-container="'+this.settings.id+'"]').remove(),$("body").prepend('<div class="imp-tooltips-container" data-imp-tooltips-container="'+this.settings.id+'"></div>'),this.tooltipsContainer=$('[data-imp-tooltips-container="'+this.settings.id+'"]'),this.events(),this.centerImageMap(),this.drawShapes(),this.generateShapeStyleClasses(),this.addTooltips(),this.initFullscreen(),this.initZoom(),this.drawShapesMenu(),this.adjustSize(),this.initNavigator(),this.initLayers(),this.animateShapesLoop(),$.imageMapProInitialized(this.settings.general.name),t&&t()},parseSettings:function(){this.settings.general.image_url&&(this.settings.image.url=this.settings.general.image_url);for(var t=0;t<this.settings.spots.length;t++){var e,i=this.settings.spots[t];i.tooltip_style&&i.tooltip_style.enable_tooltip&&(i.tooltip.enable_tooltip=i.tooltip_style.enable_tooltip,i.tooltip_style.enable_tooltip=undefined),i.tooltip_content.plain_text&&"content-builder"!=i.tooltip_content.content_type&&(e={containers:[{id:"sq-container-160121",settings:{elements:[{settings:{name:"Paragraph",iconClass:"fa fa-paragraph"},options:{text:{text:i.tooltip_content.plain_text},font:{text_color:i.tooltip_content.plain_text_color}}}]}}]},i.tooltip_content.squares_settings=e,i.tooltip_content.content_type=undefined,i.tooltip_content.plain_text=undefined,i.tooltip_content.plain_text_color=undefined),i.default_style&&i.default_style.fill&&(i.default_style.background_color=i.default_style.fill,delete i.default_style.fill),i.default_style&&i.default_style.fill_opacity&&(i.default_style.background_opacity=i.default_style.fill_opacity,delete i.default_style.fill_opacity),i.mouseover_style&&i.mouseover_style.fill&&(i.mouseover_style.background_color=i.mouseover_style.fill,delete i.mouseover_style.fill),i.mouseover_style&&i.mouseover_style.fill_opacity&&(i.mouseover_style.background_opacity=i.mouseover_style.fill_opacity,delete i.mouseover_style.fill_opacity)}},loadImage:function(t,e,i){if(isTrue(this.settings.layers.enable_layers))for(var s=0;s<this.settings.layers.layers_list.length;s++){var n=new Image;n.src=this.settings.layers.layers_list[s].image_url;var o=0,a=this;$(n).on("load",(function(){++o===a.settings.layers.layers_list.length&&i()}))}else t.complete&&t.naturalWidth!==undefined&&t.naturalHeight!==undefined?i():(e(),$(t).on("load",(function(){$(t).off("load"),i()})))},centerImageMap:function(){isTrue(this.settings.general.center_image_map)&&this.wrap.css({margin:"0 auto"})},adjustSize:function(){if(isTrue(this.settings.runtime.is_fullscreen)){var t=$(window).width(),e=$(window).height();isTrue(this.settings.shapes_menu.enable_shapes_menu)&&!this.responsiveShapesMenu&&(t-=240);var i=this.settings.general.naturalWidth/this.settings.general.naturalHeight;return i<t/e?(this.settings.general.width=e*i,this.settings.general.height=e):(this.settings.general.width=t,this.settings.general.height=t/i),this.wrap.css({width:this.settings.general.width,height:this.settings.general.height}),this.wrapWidth=this.wrap.width(),this.wrapHeight=this.wrap.height(),this.wrapOffsetLeft=this.wrap.offset().left,void(this.wrapOffsetTop=this.wrap.offset().top)}""!=this.settings.image.url?isTrue(this.settings.general.responsive)?isTrue(this.settings.general.preserve_quality)&&this.wrap.css({"max-width":this.settings.general.naturalWidth}):this.wrap.css({width:this.settings.general.width,height:this.settings.general.height}):isTrue(this.settings.general.responsive)?(this.wrap.css({width:"100%",height:this.settings.general.height,"max-width":this.settings.general.width,"max-height":this.settings.general.height}),this.wrap.css({height:this.wrap.width()*(this.settings.general.height/this.settings.general.width)})):this.wrap.css({width:this.settings.general.width,height:this.settings.general.height}),this.wrapWidth=this.wrap.width(),this.wrapHeight=this.wrap.height(),this.wrapOffsetLeft=this.wrap.offset().left,this.wrapOffsetTop=this.wrap.offset().top},drawShapes:function(){for(var t=0;t<this.settings.spots.length;t++)if((f=this.settings.spots[t]).x=parseFloat(f.x),f.y=parseFloat(f.y),f.width=parseFloat(f.width),f.height=parseFloat(f.height),f.default_style.stroke_width=parseInt(f.default_style.stroke_width),f.mouseover_style.stroke_width=parseInt(f.mouseover_style.stroke_width),"poly"===f.type)for(var e=0;e<f.points.length;e++)f.points[e].x=parseFloat(f.points[e].x),f.points[e].y=parseFloat(f.points[e].y);this.settings.general.width=parseInt(this.settings.general.width),this.settings.general.height=parseInt(this.settings.general.height),this.zoomWrap.prepend('<div class="imp-shape-container"></div>'),this.zoomWrap.prepend('<div class="imp-image-backgrounds-container" id="imp-image-backgrounds-container-'+this.settings.id+'"></div>'),this.shapeContainer=this.wrap.find(".imp-shape-container"),this.imageBackgroundsContainer=this.wrap.find(".imp-image-backgrounds-container");var i="",s=this.settings.general.width,n=this.settings.general.height;isTrue(this.settings.general.responsive)&&(s=this.settings.general.naturalWidth,n=this.settings.general.naturalHeight);var o='<svg class="hs-poly-svg" viewBox="0 0 '+s+" "+n+'" preserveAspectRatio="none">';for(t=0;t<this.settings.spots.length;t++)if(!isTrue(this.settings.layers.enable_layers)||parseInt(this.settings.spots[t].layerID,10)===parseInt(this.settings.runtime.layerID)){var a,r,h,l,p,d="";if(isTrue((f=this.settings.spots[t]).static)&&(d="imp-shape-static"),"spot"===f.type&&(isTrue(f.default_style.use_icon)?(a="imp-shape-spot",isTrue(f.default_style.icon_is_pin)&&(a+=" imp-shape-spot-pin"),i+='<div class="imp-shape '+d+" "+a+'" id="'+f.id+'" data-shape-title="'+f.title+'" data-index='+t+">","library"===f.default_style.icon_type&&(r="",r+="line-height: "+f.height+"px;",i+='   <div class="imp-spot-fontawesome-icon" style="'+(r+="font-size: "+f.height+"px;")+'">',i+='       <i class="fa fa-'+f.default_style.icon_fontawesome_id+'"></i>',i+="   </div>"),"custom"===f.default_style.icon_type&&0<f.default_style.icon_url.length&&(i+='<img src="'+f.default_style.icon_url+'" style="width: '+f.width+"px; height: "+f.height+'px">'),isTrue(f.default_style.icon_shadow)&&(r="",r+="width: "+f.width+"px;",r+="height: "+f.height+"px;",i+='<div style="'+(r+="top: "+f.height/2+"px;")+'" class="imp-shape-icon-shadow"></div>'),isTrue(this.settings.shapes.glowing_shapes)&&(l="",l+="width: "+f.width/3+"px;",l+="height: "+f.height/3+"px;",l+="margin-left: "+-f.width/6+"px;",l+="margin-top: "+-f.height/6+"px;",l+="border-radius: "+f.width/3+"px;",l+="background: rgba("+(p=hexToRgb(this.settings.shapes.glowing_shapes_color)||{r:0,b:0,g:0}).r+", "+p.g+", "+p.b+", "+this.settings.shapes.glow_opacity+");",i+='<div class="imp-spot-glow" style="'+(l+="box-shadow: 0 0 20px 15px rgba("+p.r+", "+p.g+", "+p.b+", "+this.settings.shapes.glow_opacity+");")+'"></div>'),i+="</div>"):(h="",isTrue(this.settings.shapes.glowing_shapes)&&(l="",l+="box-shadow: 0 0 20px 15px rgba("+(p=hexToRgb(this.settings.shapes.glowing_shapes_color)||{r:0,b:0,g:0}).r+", "+p.g+", "+p.b+", "+this.settings.shapes.glow_opacity+");",h+='<div class="imp-shape-glow" style="'+(l+="border-radius: 50% 50%;")+'"></div>'),i+='<div class="imp-shape '+d+' imp-shape-spot" id="'+f.id+'" data-shape-title="'+f.title+'" data-index='+t+">"+h+"</div>")),"text"===f.type&&(i+='<div class="imp-shape '+d+' imp-shape-text" id="'+f.id+'" data-shape-title="'+f.title+'" data-index='+t+">"+f.text.text+"</div>"),"rect"===f.type&&(h="",isTrue(this.settings.shapes.glowing_shapes)&&(l="",l+="box-shadow: 0 0 20px 15px rgba("+(p=hexToRgb(this.settings.shapes.glowing_shapes_color)||{r:0,b:0,g:0}).r+", "+p.g+", "+p.b+", "+this.settings.shapes.glow_opacity+");",h+='<div class="imp-shape-glow" style="'+(l+="border-radius: "+f.default_style.border_radius+"px;")+'"></div>'),i+='<div class="imp-shape '+d+' imp-shape-rect" id="'+f.id+'" data-shape-title="'+f.title+'" data-index='+t+">"+h+"</div>"),"oval"===f.type&&(h="",isTrue(this.settings.shapes.glowing_shapes)&&(l="",l+="box-shadow: 0 0 20px 15px rgba("+(p=hexToRgb(this.settings.shapes.glowing_shapes_color)||{r:0,b:0,g:0}).r+", "+p.g+", "+p.b+", "+this.settings.shapes.glow_opacity+");",h+='<div class="imp-shape-glow" style="'+(l+="border-radius: 50% 50%;")+'"></div>'),i+='<div class="imp-shape '+d+' imp-shape-oval" id="'+f.id+'" data-shape-title="'+f.title+'" data-index='+t+">"+h+"</div>"),"poly"===f.type){if(f.points.length<3)continue;o+='<polygon class="imp-shape '+d+' imp-shape-poly" data-index='+t+' id="'+f.id+'" data-shape-title="'+f.title+'" points="';var g=s*(f.width/100),u=n*(f.height/100);for(f.vs=new Array,e=0;e<f.points.length;e++){var c=s*(f.x/100)+f.points[e].x/100*g,m=n*(f.y/100)+f.points[e].y/100*u;o+=c+","+m+" ",f.vs.push([c,m])}o+='"></polygon>'}"path"===f.type&&(g=s*(f.width/100),u=n*(f.height/100),o+='<path class="imp-shape '+d+' imp-shape-poly" data-index='+t+' id="'+f.id+'" data-shape-title="'+f.title+'" d="'+f.d+'"></path>')}o+="</svg>";var f,_,y="";for(t=0;t<this.settings.spots.length;t++)isTrue(this.settings.layers.enable_layers)&&parseInt(this.settings.spots[t].layerID,10)!==parseInt(this.settings.runtime.layerID)||(_="",_+="left: "+((f=this.settings.spots[t]).x_image_background+f.default_style.background_image_offset_x)+"%;",_+="top: "+(f.y_image_background+f.default_style.background_image_offset_y)+"%;",_+="width: "+f.width_image_background+"%;",_+="height: "+f.height_image_background+"%;","image"===f.default_style.background_type&&f.default_style.background_image_url&&(_+="opacity: "+f.default_style.background_image_opacity+";",_+="transform: scale("+f.default_style.background_image_scale+");"),y+='<div class="imp-shape-background-image" style="'+_+'" data-id="'+f.id+'"></div>');this.shapeContainer.html(i+o),this.imageBackgroundsContainer.html(y)},generateShapeStyleClasses:function(){$("style#"+this.settings.id).remove();var t=document.createElement("style");$(t).attr("id",this.settings.id);for(var e="",i=0;i<this.settings.spots.length;i++){var s=this.settings.spots[i];e+="#"+s.id+" {",e+=this.calcStyles(s.default_style,i),e+="}","spot"===s.type&&0<$("#"+s.id).find("path").length&&(e+="#"+s.id+" path {",e+="fill: "+s.default_style.icon_fill,e+="}"),"image"===s.default_style.background_type&&(e+="#imp-image-backgrounds-container-"+this.settings.id+' [data-id="'+s.id+'"] {',e+="background-image: url("+s.default_style.background_image_url+");",e+="opacity:"+s.default_style.background_image_opacity+";",e+="transform: scale("+s.default_style.background_image_scale+") translate("+s.default_style.background_image_offset_x+"px, "+s.default_style.background_image_offset_y+"px);",e+="}"),e+=".imp-shape-highlighted#"+s.id+" {",e+=this.calcStyles(s.mouseover_style,i),e+="}","spot"===s.type&&0<$("#"+s.id).find("path").length&&(e+=".imp-shape-highlighted#"+s.id+" path {",e+="fill: "+s.mouseover_style.icon_fill,e+="}")}t.innerHTML=e,document.body.appendChild(t)},drawShapesMenu:function(){if(isTrue(this.settings.shapes_menu.enable_shapes_menu)){this.shapesMenuWrap&&this.shapesMenuWrap.remove(),this.shapesMenuResponsiveButton&&this.shapesMenuResponsiveButton.remove(),0<$(".imp-ui-layers-menu-wrap").length&&$(".imp-ui-layers-menu-wrap").css({right:20});var t="",e="imp-shapes-menu-wrap-left",i="";if(t+='<div class="imp-shapes-menu-wrap '+(e="right"===this.settings.shapes_menu.menu_position?"imp-shapes-menu-wrap-right":e)+" "+(i=isTrue(this.settings.shapes_menu.enable_search)?"imp-shapes-menu-wrap-with-search-box":i)+'">',i="",this.responsiveShapesMenu&&(i='<div data-imp-id="'+this.settings.id+'" class="imp-close-responsive-menu"><i class="fa fa-times" aria-hidden="true"></i></div>'),isTrue(this.settings.shapes_menu.enable_search)&&(t+='<div class="imp-shapes-menu-search-box">',t+='   <div class="imp-shapes-menu-search-box-input-wrap">',t+='       <input type="text" placeholder="Search..." data-image-map-pro-search-id="'+this.settings.id+'">',t+='       <i class="fa fa-search" aria-hidden="true"></i>',t+='       <i class="fa fa-times imp-clear-search" aria-hidden="true" data-image-map-pro-id="'+this.settings.id+'"></i>',t+="   </div>",t+=i,t+="</div>"),t+='   <div class="imp-shapes-menu-scroll-wrap">',isTrue(this.settings.shapes_menu.group_by_floor)&&isTrue(this.settings.layers.enable_layers))for(var s=0;s<this.settings.layers.layers_list.length;s++){var n=this.settings.layers.layers_list[this.settings.layers.layers_list.length-s-1];t+='<div class="imp-shapes-menu-layer-title" data-imp-content="'+n.title+'">'+n.title+"</div>";for(var o=0;o<this.settings.spots.length;o++){var a=this.settings.spots[o];isTrue(this.settings.shapes_menu.hide_children_of_connected_shapes)&&""!=a.connected_to||parseInt(a.layerID,10)===parseInt(n.id,10)&&(t+='<div class="imp-shapes-menu-shape-title" data-imp-image-map-name="'+this.settings.general.name+'" data-imp-highlight-shape-on-mouseover="'+a.title+'" data-imp-focus-shape-on-click="'+a.title+'" data-imp-content="'+a.title+'">'+a.title+"</div>")}}else for(o=0;o<this.settings.spots.length;o++)a=this.settings.spots[this.settings.spots.length-o-1],isTrue(this.settings.shapes_menu.hide_children_of_connected_shapes)&&""!=a.connected_to||(t+='<div class="imp-shapes-menu-shape-title" data-imp-image-map-name="'+this.settings.general.name+'" data-imp-highlight-shape-on-mouseover="'+a.title+'" data-imp-focus-shape-on-click="'+a.title+'" data-imp-content="'+a.title+'">'+a.title+"</div>");t+="   </div>",t+="</div>",isTrue(this.settings.shapes_menu.detached_menu)?($('[data-imp-detached-menu="'+this.settings.id+'"]').html(t),this.shapesMenuWrap=$('[data-imp-detached-menu="'+this.settings.id+'"]').find(".imp-shapes-menu-wrap")):this.responsiveShapesMenu?(this.responsiveShapesMenuWrap||($("body").append('<div data-imp-id="'+this.settings.id+'" class="imp-responsive-menu"></div>'),this.responsiveShapesMenuWrap=$('.imp-responsive-menu[data-imp-id="'+this.settings.id+'"]')),this.responsiveShapesMenuWrap.append(t),this.shapesMenuWrap=this.responsiveShapesMenuWrap.find(".imp-shapes-menu-wrap"),i="",i+='<div data-imp-id="'+this.settings.id+'" class="imp-ui-element imp-shapes-menu-button">',i+='<i class="fa fa-bars" aria-hidden="true"></i>',this.ui.append(i+="</div>"),this.shapesMenuResponsiveButton=this.ui.find(".imp-shapes-menu-button"),0<$(".imp-ui-layers-menu-wrap").length&&$(".imp-ui-layers-menu-wrap").css({right:70}),$("#imp-fullscreen-wrap").find(".imp-fullscreen-root-wrap").removeClass("imp-shapes-menu-left"),$("#imp-fullscreen-wrap").find(".imp-fullscreen-root-wrap").removeClass("imp-shapes-menu-right")):isTrue(this.settings.runtime.is_fullscreen)?($("#imp-fullscreen-wrap").find(".imp-shapes-menu-wrap").remove(),$("#imp-fullscreen-wrap").append(t),0===$("#imp-fullscreen-wrap").find(".imp-fullscreen-root-wrap").length&&this.root.wrap('<div class="imp-fullscreen-root-wrap"></div>'),this.shapesMenuWrap=$("#imp-fullscreen-wrap").find(".imp-shapes-menu-wrap"),"left"===this.settings.shapes_menu.menu_position?$("#imp-fullscreen-wrap").find(".imp-fullscreen-root-wrap").addClass("imp-shapes-menu-left"):$("#imp-fullscreen-wrap").find(".imp-fullscreen-root-wrap").addClass("imp-shapes-menu-right")):(0===this.root.find(".imp-shapes-menu-outer-wrap").length&&this.wrap.wrap('<div class="imp-shapes-menu-outer-wrap"></div>'),"left"===this.settings.shapes_menu.menu_position?this.root.find(".imp-shapes-menu-outer-wrap").prepend(t):this.root.find(".imp-shapes-menu-outer-wrap").append(t),this.shapesMenuWrap=this.root.find(".imp-shapes-menu-wrap"),isTrue(this.settings.shapes_menu.enable_search)?this.shapesMenuWrap.height(this.wrap.height()-73):this.shapesMenuWrap.height(this.wrap.height())),this.shapesMenuWrap.find('input[data-image-map-pro-search-id="'+this.settings.id+'"]').val(this.settings.runtime.menu_search_string),this.updateMenuSearch(),this.shapesMenuWrap.find(".imp-shapes-menu-scroll-wrap").scrollTop(this.settings.runtime.menu_scroll)}},addTooltips:function(){if("always"===this.settings.tooltips.fullscreen_tooltips||"mobile-only"===this.settings.tooltips.fullscreen_tooltips&&isMobile()){this.fullscreenTooltipsContainer||($('.imp-fullscreen-tooltips-container[data-image-map-id="'+this.settings.id+'"]').remove(),$("body").prepend('<div class="imp-fullscreen-tooltips-container" data-image-map-id="'+this.settings.id+'"></div>'),this.fullscreenTooltipsContainer=$('.imp-fullscreen-tooltips-container[data-image-map-id="'+this.settings.id+'"]'));for(var t="",e=0;e<this.settings.spots.length;e++)"text"!==(i=this.settings.spots[e]).type&&(n="",s=hexToRgb(i.tooltip_style.background_color)||{r:0,b:0,g:0},n+="padding: "+i.tooltip_style.padding+"px;",n+="background: rgba("+s.r+", "+s.g+", "+s.b+", "+i.tooltip_style.background_opacity+");","none"===this.settings.tooltips.tooltip_animation&&(n+="opacity: 0;"),"fade"===this.settings.tooltips.tooltip_animation&&(n+="opacity: 0;",n+="transition-property: opacity;-moz-transition-property: opacity;-webkit-transition-property: opacity;"),"grow"===this.settings.tooltips.tooltip_animation&&(n+="transform: scale(0, 0);-moz-transform: scale(0, 0);-webkit-transform: scale(0, 0);",n+="transition-property: transform;-moz-transition-property: -moz-transform;-webkit-transition-property: -webkit-transform;",n+="transform-origin: 50% 50%;-moz-transform-origin: 50% 50%;-webkit-transform-origin: 50% 50%;"),t+='<div class="imp-fullscreen-tooltip" style="'+n+'" data-index="'+e+'">',t+='   <div class="imp-tooltip-close-button" data-index="'+e+'"><i class="fa fa-times" aria-hidden="true"></i></div>',"plain-text"===i.tooltip_content.content_type?(n="",t+='<div class="imp-tooltip-plain-text" style="'+(n+="color: "+i.tooltip_content.plain_text_color+";")+'">'+i.tooltip_content.plain_text+"</div>"):i.tooltip_content.squares_json?t+=$.squaresRendererRenderObject(i.tooltip_content.squares_json):t+=$.squaresRendererRenderObject(i.tooltip_content.squares_settings),t+="</div>");this.fullscreenTooltipsContainer.html(t)}else{var i,s,n,o;for(t="",e=0;e<this.settings.spots.length;e++)"text"!==(i=this.settings.spots[e]).type&&(n="",s=hexToRgb(i.tooltip_style.background_color)||{r:0,b:0,g:0},n+="border-radius: "+i.tooltip_style.border_radius+"px;",n+="padding: "+i.tooltip_style.padding+"px;",n+="background: rgba("+s.r+", "+s.g+", "+s.b+", "+i.tooltip_style.background_opacity+");","none"===this.settings.tooltips.tooltip_animation&&(n+="opacity: 0;",n+="transition-property: transform; -moz-transition-property: -moz-transform; -webkit-transition-property: -webkit-transform;"),"fade"===this.settings.tooltips.tooltip_animation&&(n+="opacity: 0;",n+="transition-property: transform, opacity; -moz-transition-property: -moz-transform, opacity;-webkit-transition-property: -webkit-transform, opacity;"),"grow"===this.settings.tooltips.tooltip_animation&&(n+="transform: scale(0, 0);-moz-transform: scale(0, 0);-webkit-transform: scale(0, 0);",n+="transition-property: transform; -moz-transition-property: -moz-transform; -webkit-transition-property: -webkit-transform;","top"===i.tooltip_style.position&&(n+="transform-origin: 50% 100%;-moz-transform-origin: 50% 100%;-webkit-transform-origin: 50% 100%;"),"bottom"===i.tooltip_style.position&&(n+="transform-origin: 50% 0%;-moz-transform-origin: 50% 0%;-webkit-transform-origin: 50% 0%;"),"left"===i.tooltip_style.position&&(n+="transform-origin: 100% 50%;-moz-transform-origin: 100% 50%;-webkit-transform-origin: 100% 50%;"),"right"===i.tooltip_style.position&&(n+="transform-origin: 0% 50%;-moz-transform-origin: 0% 50%;-webkit-transform-origin: 0% 50%;")),t+='<div class="imp-tooltip" style="'+n+'" data-index="'+e+'">',"top"===i.tooltip_style.position&&(t+='   <div class="hs-arrow hs-arrow-bottom" style="border-top-color: rgba('+s.r+", "+s.g+", "+s.b+", "+i.tooltip_style.background_opacity+');"></div>'),"bottom"===i.tooltip_style.position&&(t+='   <div class="hs-arrow hs-arrow-top" style="border-bottom-color: rgba('+s.r+", "+s.g+", "+s.b+", "+i.tooltip_style.background_opacity+');"></div>'),"left"===i.tooltip_style.position&&(t+='   <div class="hs-arrow hs-arrow-right" style="border-left-color: rgba('+s.r+", "+s.g+", "+s.b+", "+i.tooltip_style.background_opacity+');"></div>'),"right"===i.tooltip_style.position&&(t+='   <div class="hs-arrow hs-arrow-left" style="border-right-color: rgba('+s.r+", "+s.g+", "+s.b+", "+i.tooltip_style.background_opacity+');"></div>'),n="",n+="color: "+i.tooltip_content.plain_text_color+";",o={containers:[{id:"sq-container-403761",settings:{elements:[{settings:{name:"Paragraph",iconClass:"fa fa-paragraph"},options:{text:{text:i.title}}}]}}]},t+='<div class="imp-tooltip-title" style="'+n+'">'+$.squaresRendererRenderObject(o)+"</div>","plain-text"===i.tooltip_content.content_type?t+='<div class="imp-tooltip-plain-text" style="'+n+'">'+i.tooltip_content.plain_text+"</div>":i.tooltip_content.squares_json?t+=$.squaresRendererRenderObject(i.tooltip_content.squares_json):t+=$.squaresRendererRenderObject(i.tooltip_content.squares_settings),t+="</div>");this.tooltipsContainer.prepend(t),isTrue(this.settings.tooltips.sticky_tooltips)&&this.tooltipsContainer.addClass("imp-sticky-tooltips")}},initFullscreen:function(){var t,e,i,s;isTrue(this.settings.fullscreen.enable_fullscreen_mode)&&(t="",t+="background: "+this.settings.fullscreen.fullscreen_button_color+"; ",t+="color: "+this.settings.fullscreen.fullscreen_button_text_color+"; ",i='<i class="fa fa-arrows-alt" aria-hidden="true"></i>',isTrue(this.settings.runtime.is_fullscreen)&&(i='<i class="fa fa-times" aria-hidden="true"></i>'),s="Go Fullscreen",isTrue(this.settings.runtime.is_fullscreen)&&(s="Close Fullscreen"),e="","icon"===this.settings.fullscreen.fullscreen_button_type&&(e+=i),"text"===this.settings.fullscreen.fullscreen_button_type&&(e+=s),"icon_and_text"===this.settings.fullscreen.fullscreen_button_type&&(e+=i+" "+s),i="","icon"===this.settings.fullscreen.fullscreen_button_type&&(i+="imp-fullscreen-button-icon-only"),s="",s+='<div data-imp-id="'+this.settings.id+'" style="'+t+'" class="imp-ui-element '+i+" imp-fullscreen-button imp-fullscreen-button-position-"+this.settings.fullscreen.fullscreen_button_position+'">',s+=e,this.ui.append(s+="</div>"),isTrue(this.settings.runtime.is_fullscreen)&&($(window).scrollTop(0),fullscreenMap=this),s=this.ui.find(".imp-fullscreen-button"),1!==parseInt(this.settings.fullscreen.fullscreen_button_position,10)&&4!==parseInt(this.settings.fullscreen.fullscreen_button_position,10)||s.css({"margin-left":-s.outerWidth()/2}),isTrue(this.settings.fullscreen.start_in_fullscreen_mode)&&0===this.settings.runtime.is_fullscreen&&(this.settings.fullscreen.start_in_fullscreen_mode=0,this.toggleFullscreen()))},initNavigator:function(){isTrue(this.settings.zooming.enable_zooming)&&isTrue(this.settings.zooming.enable_navigator)&&(this.uiNavigatorRoot=this.ui.find(".imp-ui-navigator-root"),this.uiNavigatorImage=this.ui.find(".imp-ui-navigator-window-image"),this.adjustNavigatorSize())},initLayers:function(){if(isTrue(this.settings.layers.enable_layers)){for(var t=!1,e=0;e<this.settings.layers.layers_list.length;e++)parseInt(this.settings.layers.layers_list[e].id,10)===parseInt(this.settings.runtime.layerID,10)&&(t=!0);t||(this.settings.runtime.layerID=this.settings.layers.layers_list[0].id),this.wrap.find(".imp-ui-layers-select").val(this.settings.runtime.layerID)}},initZoom:function(){isTrue(this.settings.zooming.enable_zooming)&&(this.zoom=1,this.targetZoom=1,this.targetPanX=0,this.actualPanX=0,this.targetPanY=0,this.actualPanY=0,this.initialPanX=0,this.initialPanY=0,this.panDeltaY=0,isTrue(this.settings.zooming.limit_max_zoom_to_image_size)?this.maxZoomLevel=this.settings.general.naturalWidth/this.wrap.width():this.maxZoomLevel=this.settings.zooming.max_zoom)},adjustNavigatorSize:function(){var t,e,i,s;isTrue(this.settings.zooming.enable_zooming)&&isTrue(this.settings.zooming.enable_navigator)&&(isTrue(this.settings.runtime.is_fullscreen)?(this.navigatorRatio=this.uiNavigatorRoot.width()/this.settings.general.width,s=i=0,(t=this.settings.general.naturalWidth/this.settings.general.naturalHeight)<(e=window.innerWidth/window.innerHeight)?(t<1?(i=150*t,this.uiNavigatorWindowWidth=(s=150)*e):this.uiNavigatorWindowWidth=(s=(i=150)/t)*e,this.uiNavigatorWindowHeight=s,this.navigatorMarginX=i/2-this.uiNavigatorWindowWidth/2,this.navigatorMarginY=0):(t<1?this.uiNavigatorWindowWidth=i=(s=150)*t:(s=(i=150)/t,this.uiNavigatorWindowWidth=i),this.uiNavigatorWindowHeight=i/e,this.navigatorMarginX=0,this.navigatorMarginY=s/2-this.uiNavigatorWindowHeight/2)):(this.navigatorRatio=this.uiNavigatorRoot.width()/this.wrap.width(),this.uiNavigatorWindowWidth=this.uiNavigatorRoot.width(),this.uiNavigatorWindowHeight=this.uiNavigatorRoot.height()))},measureTooltipSize:function(t){var e;"always"===this.settings.tooltips.fullscreen_tooltips||"mobile-only"===this.settings.tooltips.fullscreen_tooltips&&isMobile()||(e=this.settings.spots[t],t=this.tooltipsContainer.find('.imp-tooltip[data-index="'+t+'"]'),isTrue(e.tooltip_style.auto_width)||t.css({width:e.tooltip_style.width}),t[0].getBoundingClientRect(),t.data("imp-measured-width",t.outerWidth()),t.data("imp-measured-height",t.outerHeight()))},animateShapesLoop:function(){if("none"!==this.settings.shapes.pageload_animation){this.didAnimateShapesOnPageload=!0;for(var t=750/this.settings.spots.length,e=shuffle(this.settings.spots.slice()),i=0;i<e.length;i++)this.animateShape(e[i],t*i)}},animateShape:function(t,e){var i=this,s=this.root.find("#"+t.id),n=0;setTimeout((function(){"fade"===i.settings.shapes.pageload_animation&&s.css({opacity:t.default_style.opacity}),"grow"===i.settings.shapes.pageload_animation&&s.css({transform:"scale(1, 1)","-moz-transform":"scale(1, 1)","-webkit-transform":"scale(1, 1)"}),"fall-down"===i.settings.shapes.pageload_animation&&(s.css({opacity:t.default_style.opacity}),"spot"===t.type&&(s.css({"transition-property":"opacity"}),function t(){requestAnimationFrame((function(){var e=easeOutBounce(undefined,n+=.01666,-200,200,1);s.css({transform:"translateY("+e+"px)"}),n<=1&&t()}))}()))}),e)},events:function(){var t=this;$(document).off("mousedown."+this.settings.id),$(document).on("mousedown."+this.settings.id,(function(e){touch||t.handleEventStart(e)})),$(document).off("mousemove."+this.settings.id),$(document).on("mousemove."+this.settings.id,(function(e){touch||t.handleEventMove(e)})),$(document).off("mouseup."+this.settings.id),$(document).on("mouseup."+this.settings.id,(function(e){touch||t.handleEventEnd(e)})),$(document).off("touchstart."+this.settings.id),$(document).on("touchstart."+this.settings.id,(function(e){touch||t.handleEventStart(e)})),$(document).off("touchmove."+this.settings.id),$(document).on("touchmove."+this.settings.id,(function(e){if(!touch)return t.handleEventMove(e),(!t.panning||0==t.panDeltaY)&&!t.pinching&&void 0})),$(document).off("touchend."+this.settings.id),$(document).on("touchend."+this.settings.id,(function(e){touch||t.handleEventEnd(e)})),this.wrap.off("mousewheel"),this.wrap.on("mousewheel",(function(e){if(!touch)return isTrue(t.settings.zooming.enable_zooming)?isTrue(t.settings.zooming.hold_ctrl_to_zoom)?t.mac&&t.cmdKeyDown||!t.mac&&t.ctrlKeyDown?(t.handleEventEnd(e),!1):(t.displayScrollMessage(),!0):(t.handleEventEnd(e),!(e.deltaY<0&&1<t.targetZoom||0<e.deltaY&&t.targetZoom<t.maxZoomLevel)&&void 0):void 0})),$(document).off("keydown."+this.settings.id),$(document).on("keydown."+this.settings.id,(function(e){t.handleKeyDownEvent(e)})),$(document).off("keyup."+this.settings.id),$(document).on("keyup."+this.settings.id,(function(e){t.handleKeyUpEvent(e)})),$(document).off("click."+this.settings.id,".imp-tooltip-close-button"),$(document).on("click."+this.settings.id,".imp-tooltip-close-button",(function(){t.hideAllTooltips()})),$(document).off("change."+this.settings.id,".imp-ui-layers-select"),$(document).on("change."+this.settings.id,".imp-ui-layers-select",(function(){var e=t.wrap.find(".imp-ui-layers-select").val();t.switchLayer(e)})),$(document).off("keyup."+this.settings.id,'[data-image-map-pro-search-id="'+this.settings.id+'"]'),$(document).on("keyup."+this.settings.id,'[data-image-map-pro-search-id="'+this.settings.id+'"]',(function(e){t.updateMenuSearch()})),$(document).off("change."+this.settings.id,'[data-image-map-pro-search-id="'+this.settings.id+'"]'),$(document).on("change."+this.settings.id,'[data-image-map-pro-search-id="'+this.settings.id+'"]',(function(e){t.updateMenuSearch()})),$(window).off("resize."+this.settings.general.id+this.settings.runtime.is_fullscreen),$(window).on("resize."+this.settings.general.id+this.settings.runtime.is_fullscreen,(function(){if(t.wrapWidth=t.wrap.width(),t.wrapHeight=t.wrap.height(),t.wrapOffsetLeft=t.wrap.offset().left,t.wrapOffsetTop=t.wrap.offset().top,0<t.openedTooltips.length)for(var e=0;e<t.openedTooltips.length;e++)t.updateTooltipPosition(t.openedTooltips[e]);var i,s;t.resetZoomAndPan(),t.adjustNavigatorSize(),isTrue(t.settings.shapes_menu.enable_shapes_menu)&&(i=t.responsiveShapesMenu,s=t.root.width(),t.settings.runtime.is_fullscreen&&(s=$(window).width()),isMobile()||s/3<240?t.responsiveShapesMenu=!0:t.responsiveShapesMenu=!1,i!=t.responsiveShapesMenu&&t.drawShapesMenu(),!isTrue(t.settings.shapes_menu.enable_shapes_menu)||isTrue(t.settings.shapes_menu.detached_menu)||t.settings.runtime.is_fullscreen||t.responsiveShapesMenu||(isTrue(t.settings.shapes_menu.enable_search)?t.shapesMenuWrap.height(t.wrap.height()-73):t.shapesMenuWrap.height(t.wrap.height()))),fullscreenMap&&fullscreenMap.adjustSize(),""===t.settings.image.url&&(isTrue(t.settings.general.responsive)?(t.wrap.css({width:"100%",height:t.settings.general.height,"max-width":t.settings.general.width,"max-height":t.settings.general.height}),t.wrap.css({height:t.wrap.width()*(t.settings.general.height/t.settings.general.width)})):t.wrap.css({width:t.settings.general.width,height:t.settings.general.height}))}))},disableEvents:function(){$(document).off("mousedown."+this.settings.id),$(document).off("mousemove."+this.settings.id),$(document).off("mouseup."+this.settings.id),$(document).off("touchstart."+this.settings.id),$(document).off("touchmove."+this.settings.id),$(document).off("touchend."+this.settings.id),this.wrap.off("mousewheel"),$(document).off("keydown."+this.settings.id),$(document).off("keyup."+this.settings.id),$(document).off("click."+this.settings.id,".imp-tooltip-close-button"),$(document).off("change."+this.settings.id,".imp-ui-layers-select"),$(document).off("keyup."+this.settings.id,'[data-image-map-pro-search-id="'+this.settings.id+'"]'),$(document).off("change."+this.settings.id,'[data-image-map-pro-search-id="'+this.settings.id+'"]'),$(window).off("resize."+this.settings.general.id+this.settings.runtime.is_fullscreen)},isEventOnHTMLAPIElement:function(t){return!!($(t.target).data("imp-highlight-shape-on-mouseover")||$(t.target).data("imp-highlight-shape-on-click")||$(t.target).data("imp-unhighlight-shape-on-mouseover")||$(t.target).data("imp-unhighlight-shape-on-click")||$(t.target).data("imp-open-tooltip-on-mouseover")||$(t.target).data("imp-open-tooltip-on-click")||$(t.target).data("imp-close-tooltip-on-mouseover")||$(t.target).data("imp-close-tooltip-on-click")||$(t.target).data("imp-trigger-shape-on-mouseover")||$(t.target).data("imp-trigger-shape-on-click")||$(t.target).data("imp-untrigger-shape-on-mouseover")||$(t.target).data("imp-untrigger-shape-on-click")||$(t.target).data("imp-focus-shape-on-click")||$(t.target).data("imp-focus-shape-on-mouseover"))},handleEventStart:function(t){this.targetZoom=this.zoom,this.targetPanX=this.actualPanX,this.targetPanY=this.actualPanY;var e=this.getEventCoordinates(t);if(!this.isEventOnHTMLAPIElement(t))return isTrue(this.settings.zooming.enable_zooming)?0<$(t.target).closest(".imp-ui-navigator-root").length&&$(t.target).closest(".imp-ui-navigator-root").data("imp-id")===parseInt(this.settings.id)?(this.ix=e.x,this.iy=e.y,void(this.panningOnNavigator=!0)):t.originalEvent.touches&&1<t.originalEvent.touches.length?(this.pinchInitial[0]={x:t.originalEvent.touches[0].pageX,y:t.originalEvent.touches[0].pageY},this.pinchInitial[1]={x:t.originalEvent.touches[1].pageX,y:t.originalEvent.touches[1].pageY},this.initialPanX=this.actualPanX,this.initialPanY=this.actualPanY,this.ix=(t.originalEvent.touches[0].pageX+t.originalEvent.touches[1].pageX)/2,this.iy=(t.originalEvent.touches[0].pageY+t.originalEvent.touches[1].pageY)/2,this.lastX=this.ix,this.lastY=this.iy,this.pinchInitialDistance=Math.sqrt(Math.pow(this.pinchInitial[1].x-this.pinchInitial[0].x,2)+Math.pow(this.pinchInitial[1].y-this.pinchInitial[0].y,2)),this.pinchInitialZoom=this.zoom,void(this.pinching=!0)):void(!this.panning&&0===$(t.target).closest(".imp-ui").length&&e.x>this.wrapOffsetLeft&&e.x<this.wrapOffsetLeft+this.wrapWidth&&e.y>this.wrapOffsetTop&&e.y<this.wrapOffsetTop+this.wrapHeight&&(this.ix=e.x,this.iy=e.y,this.initialPanX=this.actualPanX,this.initialPanY=this.actualPanY,this.panning=!0)):void 0},handleEventMove:function(t){if(1e3<Date.now()-this.lastWrapRecalc&&(this.lastWrapRecalc=Date.now(),this.wrapWidth=this.wrap.width(),this.wrapHeight=this.wrap.height(),this.wrapOffsetLeft=this.wrap.offset().left,this.wrapOffsetTop=this.wrap.offset().top),!this.fullscreenTooltipVisible){var e=parseInt(this.matchShapeToEvent(t)),i=this.getEventCoordinates(t),s=!1;if(!this.isPointInsideVisibleTooltip(t)||isTrue(this.settings.tooltips.sticky_tooltips)){var n,o=!1;if((i.x<this.wrapOffsetLeft||i.x>this.wrapOffsetLeft+this.wrapWidth||i.y<this.wrapOffsetTop||i.y>this.wrapOffsetTop+this.wrapHeight)&&(o=!0),s||!o){if(isTrue(this.settings.zooming.enable_zooming)){if(this.panningOnNavigator&&(n=(i.x-this.uiNavigatorRoot.offset().left)/this.navigatorRatio*this.targetZoom,o=(i.y-this.uiNavigatorRoot.offset().top)/this.navigatorRatio*this.targetZoom,this.panTo(n,o)),this.pinching)return this.pinch(t),void(this.didPan=!0);if(this.panning)return i=this.getEventCoordinates(t),this.pan(i.x,i.y),void(this.didPan=!0)}if(1===$(t.target).closest(".imp-ui").length)return this.unhighlightAllShapes(),void("mouseover"===this.settings.tooltips.show_tooltips&&this.hideAllTooltips());-1!==e&&(isTrue(this.settings.shapes.glowing_shapes)&&isTrue(this.settings.shapes.stop_glowing_on_mouseover)&&this.wrap.addClass("imp-no-glow"),this.didPan||(this.isShapeHighlighted(e)||(this.unhighlightAllShapes(),"mouseover"===this.settings.tooltips.show_tooltips&&this.hideAllTooltips(),isTrue(this.settings.tooltips.show_title_on_mouseover)&&"click"===this.settings.tooltips.show_tooltips&&this.hideAllTitles(),this.highlightShape(e,!0)),isTrue(this.settings.tooltips.enable_tooltips)&&("mouseover"===this.settings.tooltips.show_tooltips&&isTrue(this.settings.spots[e].tooltip.enable_tooltip)&&this.showTooltip(e),"click"===this.settings.tooltips.show_tooltips&&isTrue(this.settings.tooltips.show_title_on_mouseover)&&isTrue(this.settings.spots[e].tooltip.enable_tooltip)&&this.showTooltipTitle(e),0<this.openedTooltips.length&&isTrue(this.settings.tooltips.sticky_tooltips)&&"mouseover"===this.settings.tooltips.show_tooltips&&this.updateTooltipPosition(this.openedTooltips[this.openedTooltips.length-1],t),isTrue(this.settings.tooltips.show_title_on_mouseover)&&"click"===this.settings.tooltips.show_tooltips&&-1===this.openedTooltips.indexOf(e)&&this.updateTooltipPosition(e,t)))),$(t.target).is("video")||0<$(t.target).closest("video").length||-1===e&&(this.unhighlightAllShapes(),isTrue(this.settings.tooltips.show_title_on_mouseover)&&"click"===this.settings.tooltips.show_tooltips&&this.hideAllTitles(),"mouseover"===this.settings.tooltips.show_tooltips&&0<this.openedTooltips.length&&this.hideAllTooltips())}else this.hideAllTooltips()}else s=!0}},handleEventEnd:function(t){if(!this.isEventOnHTMLAPIElement(t)){if(isTrue(this.settings.zooming.enable_zooming)){if(this.panning&&(this.panning=!1,this.tooltipsContainer.removeClass("imp-no-transition")),this.pinching&&(this.pinching=!1),"mousewheel"===t.type)return this.hideAllTooltips(),this.unhighlightAllShapes(),0<t.deltaY&&this.zoomIn(t),void(t.deltaY<0&&this.zoomOut(t));if(this.panningOnNavigator&&0<$(t.target).closest(".imp-ui-navigator-root").length&&parseInt($(t.target).closest(".imp-ui-navigator-root").data("imp-id"))===parseInt(this.settings.id)){this.panningOnNavigator=!1;var e=((o=this.getEventCoordinates(t)).x-this.uiNavigatorRoot.offset().left)/this.navigatorRatio*this.targetZoom,i=(o.y-this.uiNavigatorRoot.offset().top)/this.navigatorRatio*this.targetZoom;return void this.panTo(e,i)}if(this.panningOnNavigator&&(this.panningOnNavigator=!1),0<$(t.target).closest(".imp-ui-zoom-button").length&&parseInt($(t.target).closest(".imp-ui-zoom-button").data("imp-id"))===parseInt(this.settings.id))return void(0<$(t.target).closest(".imp-ui-zoom-button-zoom-in").length?this.zoomIn():this.zoomOut())}if(0<$(t.target).closest(".imp-fullscreen-button").length&&parseInt($(t.target).closest(".imp-fullscreen-button").data("imp-id"))===parseInt(this.settings.id)&&this.toggleFullscreen(),0<$(t.target).closest(".imp-shapes-menu-button").length&&parseInt($(t.target).closest(".imp-shapes-menu-button").data("imp-id"))===parseInt(this.settings.id)&&this.showResponsiveShapesMenu(),0<$(t.target).closest(".imp-close-responsive-menu").length&&parseInt($(t.target).closest(".imp-close-responsive-menu").data("imp-id"))===parseInt(this.settings.id)&&this.hideResponsiveShapesMenu(),0<$(t.target).closest(".imp-ui-layer-switch-up").length&&parseInt($(t.target).closest(".imp-ui-layer-switch-up").data("imp-id"))===parseInt(this.settings.id))for(var s=0;s<this.settings.layers.layers_list.length;s++)if(parseInt(this.settings.layers.layers_list[s].id,10)===parseInt(this.settings.runtime.layerID,10)&&0<s){var n=this.settings.layers.layers_list[s-1].id;this.switchLayer(n);break}if(0<$(t.target).closest(".imp-ui-layer-switch-down").length&&parseInt($(t.target).closest(".imp-ui-layer-switch-down").data("imp-id"))===parseInt(this.settings.id))for(s=0;s<this.settings.layers.layers_list.length;s++)if(parseInt(this.settings.layers.layers_list[s].id,10)===parseInt(this.settings.runtime.layerID,10)&&s<this.settings.layers.layers_list.length-1){n=this.settings.layers.layers_list[s+1].id,this.switchLayer(n);break}if($(t.target).hasClass("imp-clear-search")&&$(t.target).data("image-map-pro-id")===parseInt(this.settings.id)&&($('input[data-image-map-pro-search-id="'+this.settings.id+'"]').val(""),this.updateMenuSearch()),0==$(t.target).closest(".imp-tooltip").length&&!this.fullscreenTooltipVisible){if(1===$(t.target).closest(".imp-ui").length)return this.unhighlightAllShapes(),void("mouseover"===this.settings.tooltips.show_tooltips&&this.hideAllTooltips());this.getEventRelativeCoordinates(t);s=this.matchShapeToEvent(t);var o=this.getEventCoordinates(t);-1!=s&&(o.x>this.wrapOffsetLeft&&o.x<this.wrapOffsetLeft+this.wrapWidth&&o.y>this.wrapOffsetTop&&o.y<this.wrapOffsetTop+this.wrapHeight||this.settings.runtime.is_fullscreen)&&(this.didPan||(this.isShapeHighlighted(s)||(this.unhighlightAllShapes(),"mouseover"===this.settings.tooltips.show_tooltips&&this.hideAllTooltips(),this.highlightShape(s,!0)),isTrue(this.settings.tooltips.enable_tooltips)&&isTrue(this.settings.spots[s].tooltip.enable_tooltip)&&this.showTooltip(s),0<this.openedTooltips.length&&isTrue(this.settings.tooltips.sticky_tooltips)&&"mouseover"===this.settings.tooltips.show_tooltips&&this.updateTooltipPosition(this.openedTooltips[this.openedTooltips.length-1],t),isTrue(this.settings.zooming.enable_zooming)&&this.focusShape(s)),this.performClickAction(s)),(-1===s||(o.x<this.wrapOffsetLeft||o.x>this.wrapOffsetLeft+this.wrapWidth||o.y<this.wrapOffsetTop||o.y>this.wrapOffsetTop+this.wrapHeight)&&!this.settings.runtime.is_fullscreen)&&(this.hideAllTooltips(),this.didPan||this.unhighlightAllShapes()),t.originalEvent.touches&&0===t.originalEvent.touches.length&&(this.didPan=!1),t.originalEvent.touches||(this.didPan=!1)}}},handleKeyDownEvent:function(t){t.ctrlKey&&(this.ctrlKeyDown=!0),t.metaKey&&(this.cmdKeyDown=!0)},handleKeyUpEvent:function(t){this.ctrlKeyDown=!1,this.cmdKeyDown=!1},getEventRelativeCoordinates:function(t){var e,i;return"touchstart"===t.type||"touchmove"===t.type||"touchend"===t.type||"touchcancel"===t.type?(e=(i=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0]).pageX,i=i.pageY):"mousedown"!==t.type&&"mouseup"!==t.type&&"mousemove"!==t.type&&"mouseover"!==t.type&&"mouseout"!==t.type&&"mouseenter"!==t.type&&"mouseleave"!==t.type||(e=t.pageX,i=t.pageY),e-=this.zoomWrap.offset().left,i-=this.zoomWrap.offset().top,{x:e=e/(this.wrap.width()*this.zoom)*100,y:i=i/(this.wrap.height()*this.zoom)*100}},getEventCoordinates:function(t){var e,i;return"touchstart"===t.type||"touchmove"===t.type||"touchend"===t.type||"touchcancel"===t.type?(e=(i=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0]).pageX,i=i.pageY):"mousedown"!==t.type&&"mouseup"!==t.type&&"mousemove"!==t.type&&"mouseover"!==t.type&&"mouseout"!==t.type&&"mouseenter"!==t.type&&"mouseleave"!==t.type||(e=t.pageX,i=t.pageY),{x:e,y:i}},matchShapeToCoords:function(t){for(var e=this.settings.spots.length-1;0<=e;e--)if(!isTrue(this.settings.layers.enable_layers)||parseInt(this.settings.spots[e].layerID,10)===parseInt(this.settings.runtime.layerID,10)){var i=this.settings.spots[e];if(!isTrue(i.static)){if("poly"===i.type||"path"===i.type){var s=t.x/100*this.zoomWrap.width(),n=t.y/100*this.zoomWrap.height();if(isPointInsidePolygon(s=s*this.settings.general.naturalWidth/this.zoomWrap.width(),n=n*this.settings.general.naturalHeight/this.zoomWrap.height(),i.vs))return e}if("spot"===i.type){var o=i.width<44?44:i.width,a=i.height<44?44:i.height;o/=this.zoom,a/=this.zoom;s=t.x/100*this.wrap.width(),n=t.y/100*this.wrap.height();var r=i.x/100*this.wrap.width()-o/2,h=i.y/100*this.wrap.height()-a/2,l=o;o=a;if(isTrue(i.default_style.icon_is_pin)&&isTrue(i.default_style.use_icon)&&(h-=a/2,i.height<44&&(h+=i.height/2)),isPointInsideRect(s,n,r,h,l,o))return e}if("rect"===i.type&&isPointInsideRect(t.x,t.y,i.x,i.y,i.width,i.height))return e;if("oval"===i.type&&isPointInsideEllipse(s=t.x,n=t.y,i.x+i.width/2,i.y+i.height/2,r=i.width/2,h=i.height/2))return e;i.type}}return-1},matchShapeToEvent:function(t){return $(t.target).hasClass("imp-shape")||0<$(t.target).closest(".imp-shape").length?$(t.target).data("index")||$(t.target).closest(".imp-shape").data("index"):-1},isPointInsideVisibleTooltip:function(t){for(var e=0;e<this.openedTooltips.length;e++){var i=this.getEventCoordinates(t),s=this.tooltipsContainer.find('.imp-tooltip[data-index="'+this.openedTooltips[e]+'"]'),n=this.openedTooltips[e];i.x=(i.x-this.wrap.offset().left)/this.wrap.width()*100,i.y=(i.y-this.wrap.offset().top)/this.wrap.height()*100;var o=0;o="spot"===this.settings.spots[n].type?this.settings.spots[n].tooltip_style.buffer:this.settings.spots[n].tooltip_style.buffer*this.zoom;var a=s.outerWidth(),r=s.outerHeight(),h=s.offset().left-this.wrap.offset().left,l=s.offset().top-this.wrap.offset().top;h=h/this.wrap.width()*100,l=l/this.wrap.height()*100,a=a/this.wrap.width()*100,r=r/this.wrap.height()*100,s=[];return"left"===this.settings.spots[n].tooltip_style.position&&(s=[[h,l],[h+a,l],[h+a+(o=o/this.wrap.width()*100),l+r-r/3-r/3],[h+a+o,l+r-r/3],[h+a,l+r],[h,l+r]]),"right"===this.settings.spots[n].tooltip_style.position&&(s=[[h,l],[h+a,l],[h+a,l+r],[h,l+r],[h-(o=o/this.wrap.width()*100),l+r-r/3],[h-o,l+r-r/3-r/3]]),"top"===this.settings.spots[n].tooltip_style.position&&(s=[[h,l],[h+a,l],[h+a,l+r],[h+a-a/3,l+r+(o=o/this.wrap.height()*100)],[h+a-a/3-a/3,l+r+o],[h,l+r]]),"bottom"===this.settings.spots[n].tooltip_style.position&&(s=[[h,l],[h+a-a/3-a/3,l-(o=o/this.wrap.height()*100)],[h+a-a/3,l-o],[h+a,l],[h+a,l+r],[h,l+r]]),!!isPointInsidePolygon(i.x,i.y,s)}},getIndexOfShapeWithID:function(t){for(var e=0;e<this.settings.spots.length;e++)if(this.settings.spots[e].id===t)return e},calcStyles:function(t,e){var i,s,n,o,a,r=this.settings.spots[e],h="";return"spot"===r.type&&(h+="left: "+r.x+"%;",h+="top: "+r.y+"%;",h+="width: "+r.width+"px;",h+="height: "+r.height+"px;",this.didAnimateShapesOnPageload||("fall-down"===this.settings.shapes.pageload_animation?(h+="opacity: 0;",h+="transform: translateY(-500px);"):"grow"===this.settings.shapes.pageload_animation?(h+="opacity: "+t.opacity+";",h+="transform: scale(0);"):("fade"===this.settings.shapes.pageload_animation?h+="opacity: 0;":h+="opacity: "+t.opacity+";",h+="transform: scale("+1/this.zoom+");")),s=-r.width/2,i=-r.height/2,isTrue(r.default_style.use_icon)||(n=hexToRgb(t.background_color)||{r:0,b:0,g:0},o=hexToRgb(t.border_color)||{r:0,b:0,g:0},h+="border-radius: "+t.border_radius+"px;",h+="background: rgba("+n.r+", "+n.g+", "+n.b+", "+t.background_opacity+");",h+="border-width: "+t.border_width+"px;",h+="border-style: "+t.border_style+";",h+="border-color: rgba("+o.r+", "+o.g+", "+o.b+", "+t.border_opacity+");"),isTrue(r.default_style.use_icon)&&(isTrue(r.default_style.icon_is_pin)&&(s=-r.height),"library"===r.default_style.icon_type&&(h+="color: rgba("+(e=hexToRgb(t.icon_fill)||{r:0,b:0,g:0}).r+", "+e.g+", "+e.b+", "+t.opacity+");")),h+="margin-left: "+i+"px;",h+="margin-top: "+s+"px;"),"text"===r.type&&(s=hexToRgb(r.text.text_color),h+="left: "+r.x+"%;",h+="top: "+r.y+"%;",h+="font-family: "+r.text.font_family+";",h+="font-size: "+r.text.font_size+"px;",h+="font-weight: "+r.text.font_weight+";",h+="color: rgba("+s.r+", "+s.g+", "+s.b+", "+r.text.text_opacity+");",this.didAnimateShapesOnPageload||("grow"===this.settings.shapes.pageload_animation?(h+="opacity: "+t.opacity+";",h+="transform: scale(0);"):("fade"===this.settings.shapes.pageload_animation?h+="opacity: 0;":h+="opacity: "+t.opacity+";",h+="transform: scale("+1/this.zoom+");"))),"rect"!==r.type&&"oval"!==r.type||(a=t.border_radius+"px","oval"===r.type&&(a="50% 50%"),n=hexToRgb(t.background_color)||{r:0,b:0,g:0},o=hexToRgb(t.border_color)||{r:0,b:0,g:0},h+="left: "+r.x+"%;",h+="top: "+r.y+"%;",h+="width: "+r.width+"%;",h+="height: "+r.height+"%;","color"===t.background_type&&(h+="background: rgba("+n.r+", "+n.g+", "+n.b+", "+t.background_opacity+");"),h+="border-width: "+t.border_width+"px;",h+="border-style: "+t.border_style+";",h+="border-color: rgba("+o.r+", "+o.g+", "+o.b+", "+t.border_opacity+");",h+="border-radius: "+a+";",this.didAnimateShapesOnPageload||("grow"===this.settings.shapes.pageload_animation?(h+="opacity: "+t.opacity+";",h+="transform: scale(0);"):("fade"===this.settings.shapes.pageload_animation?h+="opacity: 0;":h+="opacity: "+t.opacity+";",h+="transform: scale(1);"))),"poly"!==r.type&&"path"!==r.type||(a=hexToRgb(t.background_color)||{r:0,b:0,g:0},r=hexToRgb(t.stroke_color)||{r:0,b:0,g:0},"color"===t.background_type?h+="fill: rgba("+a.r+", "+a.g+", "+a.b+", "+t.background_opacity+");":h+="fill: rgba(0, 0, 0, 0);",h+="stroke: rgba("+r.r+", "+r.g+", "+r.b+", "+t.stroke_opacity+");",h+="stroke-width: "+t.stroke_width+"px;",h+="stroke-dasharray: "+t.stroke_dasharray+";",h+="stroke-linecap: "+t.stroke_linecap+";",this.didAnimateShapesOnPageload||("fade"===this.settings.shapes.pageload_animation?h+="opacity: 0;":h+="opacity: "+t.opacity+";")),h},highlightShape:function(t,e){t=parseInt(t);var i=this.settings.spots[t];if(1!=isTrue(this.settings.enable_layers)||i.layerID==this.settings.runtime.layerID)if(e&&""!==i.connected_to){var s=this.getIndexOfShapeWithID(i.connected_to);this.highlightShape(s,!0)}else{if(this.connectedShapes[i.id])for(var n=0;n<this.connectedShapes[i.id].length;n++)s=this.connectedShapes[i.id][n].index,this.highlightShape(s,!1);(e=this.root.find("#"+i.id)).attr("class",e.attr("class")+" imp-shape-highlighted"),"image"===i.mouseover_style.background_type&&(console.log(i.mouseover_style.background_image_url),this.imageBackgroundsContainer.find('[data-id="'+i.id+'"]').css({"background-image":'url("'+i.mouseover_style.background_image_url+'")',opacity:i.mouseover_style.background_image_opacity,transform:"scale("+i.mouseover_style.background_image_scale+") translate("+i.mouseover_style.background_image_offset_x+"px, "+i.mouseover_style.background_image_offset_y+"px)"})),$.imageMapProEventHighlightedShape(this.settings.general.name,i.title),-1===this.highlightedShapes.indexOf(t)&&this.highlightedShapes.push(t)}},unhighlightShape:function(t){t=parseInt(t);var e,i=this.settings.spots[t];isTrue(this.settings.layers.enable_layers)&&parseInt(i.layerID)!=parseInt(this.settings.runtime.layerID)||-1==this.apiHighlightedShapes.indexOf(t)&&((e=this.root.find("#"+i.id)).attr("class",e.attr("class").replace(" imp-shape-highlighted","")),"image"===i.default_style.background_type&&this.imageBackgroundsContainer.find('[data-id="'+i.id+'"]').css({"background-image":"url("+i.default_style.background_image_url+")",opacity:i.default_style.background_image_opacity,transform:"scale("+i.default_style.background_image_scale+") translate("+i.default_style.background_image_offset_x+"px, "+i.default_style.background_image_offset_y+"px)"}),$.imageMapProEventUnhighlightedShape(this.settings.general.name,i.title),t=this.highlightedShapes.indexOf(t),this.highlightedShapes.splice(t,1))},unhighlightAllShapes:function(){for(var t=this.highlightedShapes.slice(0),e=0;e<t.length;e++)this.unhighlightShape(t[e])},isShapeHighlighted:function(t){for(var e=0;e<this.highlightedShapes.length;e++)if(this.highlightedShapes[e]===t)return!0;return!1},focusShape:function(t){if(isTrue(this.settings.zooming.enable_zooming)){for(var e=[],i=0;i<this.settings.spots.length;i++)this.settings.spots[i].connected_to===this.settings.spots[t].id&&e.push(this.settings.spots[i]);var s=this.settings.spots[t],n=0,o=0;if(0<e.length){var a=999,r=999,h=0,l=0;for(s.x<a&&(a=s.x),s.y<r&&(r=s.y),s.x>h&&(h=s.x),s.y>l&&(l=s.y),i=0;i<e.length;i++)e[i].x<a&&(a=e[i].x),e[i].y<r&&(r=e[i].y),e[i].x>h&&(h=e[i].x),e[i].y>l&&(l=e[i].y);n=h-a,o=l-r}else"spot"===s.type?((n/=this.wrapWidth)<25&&(n=25),(o/=this.wrapHeight)<25&&(o=25)):(n=s.width,o=s.height);(n=(n=50/(n<o?o:o<=n?n:0))<1?1:n)>this.maxZoomLevel&&(n=this.maxZoomLevel);var p=0,d=0;d="spot"===s.type?(p=s.x,s.y):(p=s.x+s.width/2,s.y+s.height/2);if(0<e.length){for(i=0;i<e.length;i++)"spot"===e[i].type?(p+=e[i].x,d+=e[i].y):(p+=e[i].x+e[i].width/2,d+=e[i].y+e[i].height/2);p/=e.length+1,d/=e.length+1}p=p/100*this.wrapWidth*n,d=d/100*this.wrapHeight*n,this.applyZoom(n),this.panTo(p,d)}},performClickAction:function(i){var s=this.settings.spots[i];"follow-link"===s.actions.click&&(0===$("#imp-temp-link").length&&$("body").append('<a href="" id="imp-temp-link" target="_blank"></a>'),$("#imp-temp-link").attr("href",s.actions.link),isTrue(s.actions.open_link_in_new_window)?$("#imp-temp-link").attr("target","_blank"):$("#imp-temp-link").removeAttr("target"),$("#imp-temp-link")[0].click()),"run-script"===s.actions.click&&eval(s.actions.script.replace("<br>","")),$.imageMapProEventClickedShape(this.settings.general.name,this.settings.spots[i].title)},showTooltip:function(t,e){var i,s,n=this.settings.spots[t];"text"!==n.type&&-1==this.openedTooltips.indexOf(t)&&(isTrue(this.settings.tooltips.show_title_on_mouseover)&&"click"===this.settings.tooltips.show_tooltips&&((s=this.tooltipsContainer.find('.imp-tooltip[data-index="'+t+'"]')).find(".imp-tooltip-title").hide(),s.find(".imp-tooltip-plain-text").show(),s.find(".squares-container").show(),s.css({left:0,top:0})),""!=n.connected_to&&isTrue(n.use_connected_shape_tooltip)?(n=this.getIndexOfShapeWithID(n.connected_to),this.showTooltip(n)):(0<this.openedTooltips.length&&this.hideAllTooltips(),-1===this.openedTooltips.indexOf(t)&&this.openedTooltips.push(t),"mobile-only"===this.settings.tooltips.fullscreen_tooltips&&isMobile()||"always"===this.settings.tooltips.fullscreen_tooltips?(this.visibleFullscreenTooltip=$('.imp-fullscreen-tooltip[data-index="'+t+'"]'),this.visibleFullscreenTooltipIndex=t,this.fullscreenTooltipsContainer.show(),this.visibleFullscreenTooltip.show(),i=this,setTimeout((function(){i.visibleFullscreenTooltip.addClass("imp-tooltip-visible")}),20),this.fullscreenTooltipVisible=!0,this.bodyOverflow=$("body").css("overflow"),$("body").css({overflow:"hidden"})):((s=this.tooltipsContainer.find('.imp-tooltip[data-index="'+t+'"]')).show(),setTimeout((function(){s.addClass("imp-tooltip-visible")}),1),this.measureTooltipSize(t),this.updateTooltipPosition(t,e)),$.imageMapProEventOpenedTooltip(this.settings.general.name,this.settings.spots[t].title)))},hideTooltip:function(t){var e,i;"text"!==this.settings.spots[t].type&&-1==this.apiOpenedTooltips.indexOf(t)&&(e=this.openedTooltips.indexOf(t),this.openedTooltips.splice(e,1),"mobile-only"===this.settings.tooltips.fullscreen_tooltips&&isMobile()||"always"===this.settings.tooltips.fullscreen_tooltips?((i=this.fullscreenTooltipsContainer.find('.imp-fullscreen-tooltip[data-index="'+t+'"]')).removeClass("imp-tooltip-visible"),this.fullscreenTooltipsContainer.hide(),i.hide(),this.fullscreenTooltipVisible=!1,$("body").css({overflow:this.bodyOverflow})):(i=this.tooltipsContainer.find('.imp-tooltip[data-index="'+t+'"]'),setTimeout((function(){i.removeClass("imp-tooltip-visible"),i.hasClass("imp-tooltip-visible")||i.hide()}),1),i.find("video").trigger("pause"),i.find("iframe").each((function(){$(this).attr("src",$(this).attr("src"))}))),$.imageMapProEventClosedTooltip(this.settings.general.name,this.settings.spots[t].title))},hideAllTooltips:function(){for(var t=this.openedTooltips.slice(0),e=0;e<t.length;e++)this.hideTooltip(t[e])},hideAllTitles:function(){for(var t=0;t<this.settings.spots.length;t++)this.hideTooltipTitle(t,!0)},showTooltipTitle:function(t,e){var i;"text"!==this.settings.spots[t].type&&-1==this.openedTooltips.indexOf(t)&&((i=this.tooltipsContainer.find('.imp-tooltip[data-index="'+t+'"]')).hasClass("imp-tooltip-visible")||(i.find(".squares-container").hide(),i.find(".imp-tooltip-title").show(),i.find(".imp-tooltip-title .squares-container").show(),i.find(".imp-tooltip-plain-text").hide(),i.show(),setTimeout((function(){i.addClass("imp-tooltip-visible")}),1),i.data("imp-measured-width",i.outerWidth()),i.data("imp-measured-height",i.outerHeight())),this.updateTooltipPosition(t,e))},hideTooltipTitle:function(t){"text"!==this.settings.spots[t].type&&-1==this.openedTooltips.indexOf(t)&&((t=this.tooltipsContainer.find('.imp-tooltip[data-index="'+t+'"]')).find(".imp-tooltip-title").hide(),t.find(".imp-tooltip-plain-text").show(),t.find(".squares-container").show(),t.css({width:"auto"}),t.removeClass("imp-tooltip-visible"),t.hide())},updateTooltipPosition:function(t,e){var i,s,n,o,a,r,h,l,p,d,g;this.fullscreenTooltipVisible||(s=(i=this.tooltipsContainer.find('.imp-tooltip[data-index="'+t+'"]')).data("imp-measured-width"),n=i.data("imp-measured-height"),o=this.settings.spots[t],a=window.innerWidth,t=window.innerHeight,isTrue(this.settings.tooltips.sticky_tooltips)&&e?(l=(h=this.getEventCoordinates(e)).x,g=h.y,r=l-this.wrapOffsetLeft,h=g-this.wrapOffsetTop,g=l=0):(l=o.width/100*this.wrapWidth,g=o.height/100*this.wrapHeight,l*=this.targetZoom,g*=this.targetZoom,r=Math.round(10*o.x)/10/100*this.wrapWidth,h=Math.round(10*o.y)/10/100*this.wrapHeight,r=r*this.targetZoom+this.targetPanX,h=h*this.targetZoom+this.targetPanY),"spot"===o.type&&(r-=o.width/2,isTrue(this.settings.tooltips.sticky_tooltips)||(h-=o.height/2),l=o.width,g=o.height),"spot"===o.type&&isTrue(o.default_style.icon_is_pin)&&"spot"===o.type&&isTrue(o.default_style.use_icon)&&!isTrue(this.settings.tooltips.sticky_tooltips)&&(h-=g/2),isTrue(this.settings.runtime.is_fullscreen)&&isTrue(this.settings.tooltips.constrain_tooltips)?(r+this.wrapOffsetLeft<0&&(l=l+r+this.wrapOffsetLeft,r=-this.wrapOffsetLeft),r+this.wrapOffsetLeft+l>a&&(l+=a-(r+this.wrapOffsetLeft+l)),h+this.wrapOffsetTop<0&&(g=g+h+this.wrapOffsetTop,h=-this.wrapOffsetTop),h+this.wrapOffsetTop+g>t&&(g+=t-(h+this.wrapOffsetTop+g))):(r<0&&(l+=r,r=0),r+l>this.wrapWidth&&(l=this.wrapWidth-r),h<0&&(g+=h,h=0),h+g>this.wrapHeight&&(g=this.wrapHeight-h)),"left"===o.tooltip_style.position&&(p=r-s-20,d=h+g/2-n/2),"right"===o.tooltip_style.position&&(p=r+l+20,d=h+g/2-n/2),"top"===o.tooltip_style.position&&(p=r+l/2-s/2,d=h-n-20),"bottom"===o.tooltip_style.position&&(p=r+l/2-s/2,d=h+g+20),g={x:p,y:d},isTrue(this.settings.tooltips.constrain_tooltips)&&((g=fitRectToScreen(p+this.wrapOffsetLeft,d+this.wrapOffsetTop,s,n)).x-=this.wrapOffsetLeft,g.y-=this.wrapOffsetTop),g.x+=o.tooltip_style.offset_x/100*this.wrapWidth,g.y+=o.tooltip_style.offset_y/100*this.wrapHeight,i.css({left:g.x+this.wrapOffsetLeft-this.tooltipsContainer.offset().left,top:g.y+this.wrapOffsetTop-this.tooltipsContainer.offset().top}))},updateOpenedTooltipsPosition:function(){for(var t=0;t<this.openedTooltips.length;t++)this.updateTooltipPosition(this.openedTooltips[t])},toggleFullscreen:function(){var t,e;isTrue(this.settings.runtime.is_fullscreen)?($("body").removeClass("imp-fullscreen-mode"),$("#imp-fullscreen-wrap").remove(),this.disableEvents(),fullscreenMapParent.events()):($("body").addClass("imp-fullscreen-mode"),(t=$.extend(!0,{},this.settings)).runtime.is_fullscreen=1,t.id="999999",t.general.responsive=0,t.general.width=this.settings.general.naturalWidth,t.general.height=this.settings.general.naturalHeight,t.general.name+="-fullscreen",isTrue(this.settings.shapes_menu.enable_shapes_menu)&&isTrue(this.settings.shapes_menu.detached_menu)&&(t.shapes_menu.detached_menu=0),e="",e+="background: "+this.settings.fullscreen.fullscreen_background,$("body").append('<div id="imp-fullscreen-wrap" style="'+e+'"><div id="image-map-pro-'+t.id+'"></div></div>'),$("#image-map-pro-"+t.id).imageMapPro(t),this.disableEvents(),fullscreenMapParent=this)},resetZoomAndPan:function(){this.zoom=1,this.targetZoom=1,this.targetPanX=0,this.targetPanY=0,this.actualPanX=0,this.actualPanY=0,this.redraw(!1)},zoomIn:function(t){var e,i,s,n,o;this.targetZoom<this.maxZoomLevel&&(e=this.zoom*this.zoomMultiplier,i=0,s=this.wrap.width(),n=this.wrap.height(),o=t?(i=t.pageX,t.pageY):(i=this.wrap.offset().left+s/2,this.wrap.offset().top+n/2),this.applyZoom(e,i,o))},zoomOut:function(t){var e,i,s,n,o;1<this.targetZoom&&(e=this.zoom/this.zoomMultiplier,i=0,s=this.wrap.width(),n=this.wrap.height(),o=t?(i=t.pageX,t.pageY):(i=this.wrap.offset().left+s/2,this.wrap.offset().top+n/2),this.applyZoom(e,i,o))},applyZoom:function(t,e,i){this.targetZoom=this.zoom,this.targetPanX=this.actualPanX,this.targetPanY=this.actualPanY,t>this.maxZoomLevel&&(t=this.maxZoomLevel),this.targetZoom=t=t<1?1:t;var s=(this.wrapWidth*this.targetZoom-this.wrapWidth*this.zoom)/2;t=(this.wrapHeight*this.targetZoom-this.wrapHeight*this.zoom)/2;e&&i&&(e-=this.zoomWrap.offset().left,i-=this.zoomWrap.offset().top,e=s*((this.wrapWidth*this.zoom/2-e)/(this.wrapWidth*this.zoom/2)),i=t*((this.wrapHeight*this.zoom/2-i)/(this.wrapHeight*this.zoom/2)),this.targetPanX-=s,this.targetPanY-=t,this.targetPanX+=e,this.targetPanY+=i),0<this.targetPanX&&(this.targetPanX=0),0<this.targetPanY&&(this.targetPanY=0),this.targetPanX<this.wrapWidth-this.wrapWidth*this.targetZoom&&(this.targetPanX=this.wrapWidth-this.wrapWidth*this.targetZoom),this.targetPanY<this.wrapHeight-this.wrapHeight*this.targetZoom&&(this.targetPanY=this.wrapHeight-this.wrapHeight*this.targetZoom);for(var n=0;n<this.settings.spots.length;n++){var o=this.settings.spots[n];"spot"===o.type&&this.wrap.find("#"+o.id).css({transform:"scale("+1/this.targetZoom+")"})}"mouseover"===this.settings.tooltips.show_tooltips?this.hideAllTooltips():this.updateOpenedTooltipsPosition(),this.redraw(!0)},pan:function(t,e){t=this.ix-t,e=this.iy-e,this.targetPanX=this.initialPanX-t,this.targetPanY=this.initialPanY-e,0<this.targetPanX&&(this.targetPanX=0),0<this.targetPanY&&(this.targetPanY=0),this.targetPanX<this.wrapWidth-this.wrapWidth*this.zoom&&(this.targetPanX=this.wrapWidth-this.wrapWidth*this.zoom),this.targetPanY<this.wrapHeight-this.wrapHeight*this.zoom&&(this.targetPanY=this.wrapHeight-this.wrapHeight*this.zoom),"mouseover"===this.settings.tooltips.show_tooltips?this.hideAllTooltips():(this.tooltipsContainer.addClass("imp-no-transition"),this.updateOpenedTooltipsPosition()),this.redraw(!1)},panTo:function(t,e){t=-t+this.wrapWidth/2,e=-e+this.wrapHeight/2,this.targetPanX=t,this.targetPanY=e,0<this.targetPanX&&(this.targetPanX=0),0<this.targetPanY&&(this.targetPanY=0),this.targetPanX<this.wrapWidth-this.wrapWidth*this.targetZoom&&(this.targetPanX=this.wrapWidth-this.wrapWidth*this.targetZoom),this.targetPanY<this.wrapHeight-this.wrapHeight*this.targetZoom&&(this.targetPanY=this.wrapHeight-this.wrapHeight*this.targetZoom),"mouseover"===this.settings.tooltips.show_tooltips?this.hideAllTooltips():this.updateOpenedTooltipsPosition(),this.redraw(!0)},pinch:function(t){var e=(t.originalEvent.touches[0].pageX+t.originalEvent.touches[1].pageX)/2,i=(t.originalEvent.touches[0].pageY+t.originalEvent.touches[1].pageY)/2;this.actualPanX+=e-this.lastX,this.actualPanY+=i-this.lastY;var s=this.wrap.width(),n=this.wrap.height(),o=this.wrap.offset().left,a=this.wrap.offset().top,r=window.innerWidth,h=window.innerHeight;isTrue(this.settings.runtime.is_fullscreen)?(s*this.zoom>r?(this.actualPanX>-o&&(this.actualPanX=-o),this.actualPanX<r-s*this.targetZoom-o&&(this.actualPanX=r-s*this.targetZoom-o)):this.actualPanX=(s-s*this.targetZoom)/2,n*this.zoom>h?(this.actualPanY>-a&&(this.actualPanY=-a),this.actualPanY<h-n*this.targetZoom-a&&(this.actualPanY=h-n*this.targetZoom-a)):this.actualPanY=(n-n*this.targetZoom)/2):(0<this.actualPanX&&(this.actualPanX=0),0<this.actualPanY&&(this.actualPanY=0),this.actualPanX<s-s*this.targetZoom&&(this.actualPanX=s-s*this.targetZoom),this.actualPanY<n-n*this.targetZoom&&(this.actualPanY=n-n*this.targetZoom)),this.lastX=e,this.lastY=i,t=Math.sqrt(Math.pow(t.originalEvent.touches[1].pageX-t.originalEvent.touches[0].pageX,2)+Math.pow(t.originalEvent.touches[1].pageY-t.originalEvent.touches[0].pageY,2))/this.pinchInitialDistance,this.applyZoom(this.pinchInitialZoom*t,e,i)},redraw:function(t){var e,i,s,n,o;t?(this.zoom=lerp(this.zoom,this.targetZoom,.1),this.actualPanX=lerp(this.actualPanX,this.targetPanX,.1),this.actualPanY=lerp(this.actualPanY,this.targetPanY,.1),Math.abs(this.zoom-this.targetZoom)<.001&&(this.zoom=this.targetZoom),Math.abs(this.actualPanX-this.targetPanX)<1&&(this.actualPanX=this.targetPanX),Math.abs(this.actualPanY-this.targetPanY)<1&&(this.actualPanY=this.targetPanY)):(this.zoom=this.targetZoom,this.actualPanX=this.targetPanX,this.actualPanY=this.targetPanY),this.zoomWrap.css({transform:"scale("+this.zoom+", "+this.zoom+")"}),this.translateWrap.css({transform:"translate("+this.actualPanX+"px, "+this.actualPanY+"px)"}),isTrue(this.settings.zooming.enable_navigator)&&isTrue(this.settings.zooming.enable_zooming)&&(e=-this.actualPanX*this.navigatorRatio/this.zoom+this.navigatorMarginX/this.zoom,i=this.wrapWidth*this.navigatorRatio-(e+ +this.uiNavigatorWindowWidth/this.zoom),s=-this.actualPanY*this.navigatorRatio/this.zoom+this.navigatorMarginY/this.zoom,n=this.wrapHeight*this.navigatorRatio-(s+ +this.uiNavigatorWindowHeight/this.zoom),this.uiNavigatorImage.css({"clip-path":"inset("+s+"px "+i+"px "+n+"px "+e+"px)","-webkit-clip-path":"inset("+s+"px "+i+"px "+n+"px "+e+"px)","-moz-clip-path":"inset("+s+"px "+i+"px "+n+"px "+e+"px)"})),t&&((o=this).zoom==this.targetZoom&&this.actualPanX==this.targetPanX&&this.actualPanY==this.targetPanY||window.requestAnimationFrame((function(){o.redraw(t)})))},switchLayer:function(t,e){this.settings.runtime.layerID=t,this.openedTooltips=[],this.apiOpenedTooltips=[],this.highlightedShapes=[],this.apiHighlightedShapes=[],this.shapesMenuWrap&&(this.settings.runtime.menu_scroll=this.shapesMenuWrap.find(".imp-shapes-menu-scroll-wrap").scrollTop());for(var i="",s=0;s<this.settings.layers.layers_list.length;s++)if(parseInt(this.settings.layers.layers_list[s].id,10)===parseInt(this.settings.runtime.layerID,10)){i=this.settings.layers.layers_list[s].title,this.settings.general.naturalWidth=this.settings.layers.layers_list[s].image_width,this.settings.general.naturalHeight=this.settings.layers.layers_list[s].image_height,isTrue(this.settings.runtime.is_fullscreen)&&(this.settings.general.width=this.settings.layers.layers_list[s].image_width,this.settings.general.height=this.settings.layers.layers_list[s].image_height);break}var n=this;this.init((function(){e&&e(),$.imageMapProEventSwitchedFloor(n.settings.general.name,i)}))},updateMenuSearch:function(){var t=$('[data-image-map-pro-search-id="'+this.settings.id+'"]').val();t&&0<t.length?(this.shapesMenuWrap.addClass("imp-searching"),$(".imp-shapes-menu-shape-title").each((function(){var e=new RegExp("("+t+")","gi"),i=$(this).data("imp-content");i!=(e=$(this).data("imp-content").replace(e,'<span class="imp-search-highlight">$&</span>'))?($(this).show(),$(this).html(e)):($(this).hide(),$(this).html(i))}))):(this.shapesMenuWrap.removeClass("imp-searching"),$(".imp-shapes-menu-shape-title, .imp-shapes-menu-layer-title").each((function(){$(this).show(),$(this).html($(this).data("imp-content"))}))),this.settings.runtime.menu_search_string=t},displayScrollMessage:function(){this.scrollMessage.fadeIn(),clearTimeout(this.hideScrollMessageTimeout);var t=this;this.hideScrollMessageTimeout=setTimeout((function(){t.scrollMessage.fadeOut()}),1e3)},showResponsiveShapesMenu:function(){this.responsiveShapesMenuWrap&&(this.responsiveShapesMenuWrap.addClass("imp-responsive-menu-visible"),$("body").addClass("imp-noscroll"))},hideResponsiveShapesMenu:function(){this.responsiveShapesMenuWrap&&(this.responsiveShapesMenuWrap.removeClass("imp-responsive-menu-visible"),$("body").removeClass("imp-noscroll"))}}),$.fn[pluginName]=function(t){return this.each((function(){$.data(this,"plugin_"+pluginName,new Plugin(this,t))}))}}(jQuery,window,document),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}((function(t){function e(e){var a,r=e||window.event,l=h.call(arguments,1),d=0,g=0,u=0,c=0,m=0,f=0;if((e=t.event.fix(r)).type="mousewheel","detail"in r&&(u=-1*r.detail),"wheelDelta"in r&&(u=r.wheelDelta),"wheelDeltaY"in r&&(u=r.wheelDeltaY),"wheelDeltaX"in r&&(g=-1*r.wheelDeltaX),"axis"in r&&r.axis===r.HORIZONTAL_AXIS&&(g=-1*u,u=0),d=0===u?g:u,"deltaY"in r&&(d=u=-1*r.deltaY),"deltaX"in r&&(g=r.deltaX,0===u&&(d=-1*g)),0!==u||0!==g){1===r.deltaMode?(d*=a=t.data(this,"mousewheel-line-height"),u*=a,g*=a):2===r.deltaMode&&(d*=a=t.data(this,"mousewheel-page-height"),u*=a,g*=a);c=Math.max(Math.abs(u),Math.abs(g));return o&&!(c<o)||s(r,o=c)&&(o/=40),s(r,c)&&(d/=40,g/=40,u/=40),d=Math[1<=d?"floor":"ceil"](d/o),g=Math[1<=g?"floor":"ceil"](g/o),u=Math[1<=u?"floor":"ceil"](u/o),p.settings.normalizeOffset&&this.getBoundingClientRect&&(c=this.getBoundingClientRect(),m=e.clientX-c.left,f=e.clientY-c.top),e.deltaX=g,e.deltaY=u,e.deltaFactor=o,e.offsetX=m,e.offsetY=f,e.deltaMode=0,l.unshift(e,d,g,u),n&&clearTimeout(n),n=setTimeout(i,200),(t.event.dispatch||t.event.handle).apply(this,l)}}function i(){o=null}function s(t,e){return p.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}var n,o,a=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],h=Array.prototype.slice;if(t.event.fixHooks)for(var l=a.length;l;)t.event.fixHooks[a[--l]]=t.event.mouseHooks;var p=t.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=r.length;i;)this.addEventListener(r[--i],e,!1);else this.onmousewheel=e;t.data(this,"mousewheel-line-height",p.getLineHeight(this)),t.data(this,"mousewheel-page-height",p.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=r.length;i;)this.removeEventListener(r[--i],e,!1);else this.onmousewheel=null;t.removeData(this,"mousewheel-line-height"),t.removeData(this,"mousewheel-page-height")},getLineHeight:function(e){var i=t(e);return(e=i["offsetParent"in t.fn?"offsetParent":"parent"]()).length||(e=t("body")),parseInt(e.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(e){return t(e).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}));